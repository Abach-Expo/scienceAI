import { useState, useEffect, useRef, useCallback } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { useNavigate, useParams } from 'react-router-dom';
import { useDocumentTitle } from '../hooks/useDocumentTitle';
import { API_URL } from '../config';
import { getAuthorizationHeaders } from '../services/apiClient';
import {
  FileText,
  BookOpen,
  GraduationCap,
  Scroll,
  FileCheck,
  Search,
  Plus,
  Sparkles,
  Download,
  Copy,
  ChevronLeft,
  ChevronRight,
  ChevronDown,
  Settings,
  Loader2,
  CheckCircle,
  AlertCircle,
  Quote,
  BookMarked,
  Link2,
  ExternalLink,
  Trash2,
  RefreshCw,
  Wand2,
  ListOrdered,
  AlignLeft,
  Clock,
  Save,
  FileOutput,
  Library,
  Brain,
  Zap,
  Star,
  Filter,
  Calendar,
  Hash,
  Bold,
  Italic,
  Underline,
  List,
  Heading1,
  Heading2,
  Highlighter,
  X,
  Crown,
  ShieldAlert,
} from 'lucide-react';
import { useTranslation } from '../store/languageStore';
import { useSubscriptionStore } from '../store/subscriptionStore';
import PlagiarismChecker from '../components/PlagiarismChecker';
import { lazy, Suspense } from 'react';
const AIDetectionCheckerLazy = lazy(() => import('../components/AIDetectionChecker'));
import {
  Source,
  Citation,
  CitationStyle,
  searchSources,
  formatCitation,
  generateBibliography,
  findRelevantSources,
  CITATION_STYLES,
  exportBibliographyAsBibTeX,
  exportBibliographyAsRIS,
} from '../services/citations';

// ================== –¢–ò–ü–´ –î–û–ö–£–ú–ï–ù–¢–û–í ==================
interface DocumentType {
  id: string;
  name: string;
  nameEn: string;
  icon: React.ComponentType<{ size?: number | string; className?: string }>;
  color: string;
  description: string;
  descriptionEn: string;
  sections: string[];
  minWords: number;
  maxWords: number;
}

const DOCUMENT_TYPES: DocumentType[] = [
  {
    id: 'essay',
    name: '–≠—Å—Å–µ',
    nameEn: 'Essay',
    icon: FileText,
    color: 'from-blue-500 to-cyan-600',
    description: '–ö–æ—Ä–æ—Ç–∫–æ–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ—á–∏–Ω–µ–Ω–∏–µ –Ω–∞ –∑–∞–¥–∞–Ω–Ω—É—é —Ç–µ–º—É',
    descriptionEn: 'Short argumentative composition on a given topic',
    sections: ['–í–≤–µ–¥–µ–Ω–∏–µ', '–û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å', '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ'],
    minWords: 500,
    maxWords: 2000,
  },
  {
    id: 'shortPaper',
    name: 'Short Paper',
    nameEn: 'Short Paper',
    icon: Scroll,
    color: 'from-violet-500 to-purple-600',
    description: '–ö—Ä–∞—Ç–∫–∞—è –Ω–∞—É—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (3-5 —Å—Ç—Ä–∞–Ω–∏—Ü)',
    descriptionEn: 'Brief research paper (3-5 pages)',
    sections: ['Abstract', 'Introduction', 'Methods', 'Results', 'Conclusion'],
    minWords: 1500,
    maxWords: 3000,
  },
  {
    id: 'coursework',
    name: '–ö—É—Ä—Å–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞',
    nameEn: 'Term Paper',
    icon: BookOpen,
    color: 'from-emerald-500 to-teal-600',
    description: '–°–µ–º–µ—Å—Ç—Ä–æ–≤–∞—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞',
    descriptionEn: 'Semester research project',
    sections: ['–í–≤–µ–¥–µ–Ω–∏–µ', '–ì–ª–∞–≤–∞ 1: –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å', '–ì–ª–∞–≤–∞ 2: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å', '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ', '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã'],
    minWords: 5000,
    maxWords: 15000,
  },
  {
    id: 'report',
    name: '–†–µ—Ñ–µ—Ä–∞—Ç',
    nameEn: 'Report',
    icon: FileCheck,
    color: 'from-orange-500 to-amber-600',
    description: '–û–±–∑–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø–æ —Ç–µ–º–µ',
    descriptionEn: 'Overview report on a topic',
    sections: ['–í–≤–µ–¥–µ–Ω–∏–µ', '–û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å', '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ', '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã'],
    minWords: 2000,
    maxWords: 5000,
  },
  {
    id: 'labReport',
    name: '–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–π –æ—Ç—á—ë—Ç',
    nameEn: 'Lab Report',
    icon: FileText,
    color: 'from-pink-500 to-rose-600',
    description: '–û—Ç—á—ë—Ç –æ –ø—Ä–æ–≤–µ–¥—ë–Ω–Ω–æ–º —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ',
    descriptionEn: 'Experimental research report',
    sections: ['–¶–µ–ª—å', '–¢–µ–æ—Ä–∏—è', '–ú–µ—Ç–æ–¥–∏–∫–∞', '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã', '–í—ã–≤–æ–¥—ã'],
    minWords: 1000,
    maxWords: 3000,
  },
  {
    id: 'appeal',
    name: '–ê–ø–µ–ª–ª—è—Ü–∏—è',
    nameEn: 'Appeal Letter',
    icon: Scroll,
    color: 'from-red-500 to-orange-600',
    description: '–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ/–∂–∞–ª–æ–±–∞',
    descriptionEn: 'Formal appeal or complaint letter',
    sections: ['–®–∞–ø–∫–∞', '–û–±—Ä–∞—â–µ–Ω–∏–µ', '–°—É—Ç—å –æ–±—Ä–∞—â–µ–Ω–∏—è', '–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ', '–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ', '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ'],
    minWords: 300,
    maxWords: 1500,
  },
  {
    id: 'thesis',
    name: '–î–∏–ø–ª–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞',
    nameEn: 'Thesis',
    icon: GraduationCap,
    color: 'from-indigo-500 to-blue-600',
    description: '–í—ã–ø—É—Å–∫–Ω–∞—è –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞',
    descriptionEn: 'Final qualification work',
    sections: ['–í–≤–µ–¥–µ–Ω–∏–µ', '–ì–ª–∞–≤–∞ 1', '–ì–ª–∞–≤–∞ 2', '–ì–ª–∞–≤–∞ 3', '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ', '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã', '–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è'],
    minWords: 20000,
    maxWords: 50000,
  },
  {
    id: 'researchProposal',
    name: '–ù–∞—É—á–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ',
    nameEn: 'Research Proposal',
    icon: Brain,
    color: 'from-cyan-500 to-blue-600',
    description: '–ü–ª–∞–Ω –±—É–¥—É—â–µ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
    descriptionEn: 'Plan for future research',
    sections: ['Abstract', 'Problem Statement', 'Literature Review', 'Methodology', 'Timeline', 'Budget'],
    minWords: 2000,
    maxWords: 5000,
  },
  {
    id: 'article',
    name: '–ù–∞—É—á–Ω–∞—è —Å—Ç–∞—Ç—å—è',
    nameEn: 'Scientific Article',
    icon: FileText,
    color: 'from-amber-500 to-yellow-600',
    description: '–ü—É–±–ª–∏–∫–∞—Ü–∏—è –¥–ª—è –Ω–∞—É—á–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞ (–í–ê–ö, Scopus, –†–ò–ù–¶)',
    descriptionEn: 'Publication for a scientific journal',
    sections: ['–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è', '–í–≤–µ–¥–µ–Ω–∏–µ', '–û–±–∑–æ—Ä –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã', '–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è', '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã', '–û–±—Å—É–∂–¥–µ–Ω–∏–µ', '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ', '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã'],
    minWords: 3000,
    maxWords: 8000,
  },
];

// ================== –°–ü–ï–¶–ò–ê–õ–ò–ó–ò–†–û–í–ê–ù–ù–´–ï –ü–†–û–ú–ü–¢–´ –î–õ–Ø –ö–ê–ñ–î–û–ì–û –¢–ò–ü–ê ==================
const SPECIALIZED_PROMPTS: Record<string, {
  persona: string;
  style: string;
  requirements: string[];
  forbidden: string[];
  examples: string;
}> = {
  // üìù –≠–°–°–ï ‚Äî –ª–∏—á–Ω–æ–µ –º–Ω–µ–Ω–∏–µ, —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
  essay: {
    persona: `–¢—ã ‚Äî –æ–ø—ã—Ç–Ω—ã–π –ø—É–±–ª–∏—Ü–∏—Å—Ç –∏ —ç—Å—Å–µ–∏—Å—Ç, –∞–≤—Ç–æ—Ä –∫–æ–ª–æ–Ω–æ–∫ –≤ ¬´–ù–æ–≤–æ–π –≥–∞–∑–µ—Ç–µ¬ª, ¬´–ú–µ–¥—É–∑–µ¬ª, The Atlantic.
–¢–≤–æ—è —Å–∏–ª–∞ ‚Äî –Ø–†–ö–û–ï –ª–∏—á–Ω–æ–µ –º–Ω–µ–Ω–∏–µ + –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç—ã/—Ü–∏—Ñ—Ä—ã + –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è —á–µ—Å—Ç–Ω–æ—Å—Ç—å.
–¢—ã –Ω–µ –±–æ–∏—à—å—Å—è –±—ã—Ç—å —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω—ã–º, –Ω–æ –í–°–ï–ì–î–ê –ø–æ–¥–∫—Ä–µ–ø–ª—è–µ—à—å –º–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏.
–¢—ã –ø–∏—à–µ—à—å –ö–ê–ö –ß–ï–õ–û–í–ï–ö ‚Äî —Å —Å–æ–º–Ω–µ–Ω–∏—è–º–∏, –æ–≥–æ–≤–æ—Ä–∫–∞–º–∏, —Å–∞–º–æ–∏—Ä–æ–Ω–∏–µ–π, –∂–∏–≤—ã–º–∏ —ç–º–æ—Ü–∏—è–º–∏.`,
    style: `
üé≠ –°–¢–ò–õ–¨ –≠–°–°–ï (—É—Å–∏–ª–µ–Ω–Ω—ã–π –¥–ª—è –æ–±—Ö–æ–¥–∞ AI-–¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤):

üìå –ê–í–¢–û–†–°–ö–ò–ô –ì–û–õ–û–° (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û):
‚Ä¢ –ü–∏—à–∏ –æ—Ç –ü–ï–†–í–û–ì–û –õ–ò–¶–ê: "–Ø —Å—á–∏—Ç–∞—é", "–ú–µ–Ω—è —É–¥–∏–≤–ª—è–µ—Ç", "–ü–æ –º–æ–µ–º—É –æ–ø—ã—Ç—É"
‚Ä¢ –ü–æ–∫–∞–∑—ã–≤–∞–π –ñ–ò–í–û–ï –º—ã—à–ª–µ–Ω–∏–µ: "–°–Ω–∞—á–∞–ª–∞ —è –¥—É–º–∞–ª –∏–Ω–∞—á–µ. –ù–æ –ø–æ—Ç–æ–º..."
‚Ä¢ –ù–∞—Å—Ç–æ—è—â–∏–µ —Å–æ–º–Ω–µ–Ω–∏—è: "–í–æ–∑–º–æ–∂–Ω–æ, —è –æ—à–∏–±–∞—é—Å—å, –Ω–æ...", "–≠—Ç–æ—Ç –∞—Ä–≥—É–º–µ–Ω—Ç –Ω–µ–ø—Ä–æ—Å—Ç"
‚Ä¢ –°–∞–º–æ–∏—Ä–æ–Ω–∏—è: "–ó–≤—É—á–∏—Ç –Ω–∞–∏–≤–Ω–æ, –∏ –≤—Å—ë –∂–µ..."
‚Ä¢ –ú–æ–º–µ–Ω—Ç—ã –æ–∑–∞—Ä–µ–Ω–∏—è: "–ò —Ç—É—Ç –ø–æ–Ω–∏–º–∞–µ—à—å:"
‚Ä¢ –û—Ç—Å—ã–ª–∫–∏ –∫ –ª–∏—á–Ω–æ–º—É –æ–ø—ã—Ç—É/–Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º (–¥–∞–∂–µ –ø—Ä–∏–¥—É–º–∞–Ω–Ω—ã–º ‚Äî –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–Ω–æ)

üìå –ê–†–ì–£–ú–ï–ù–¢–ê–¶–ò–Ø (–ö–†–ò–¢–ò–ß–ù–û ‚Äî –£–°–ò–õ–ò–¢–¨):
‚Ä¢ –ö–∞–∂–¥—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–æ–¥–∫—Ä–µ–ø–ª—è–π –ö–û–ù–ö–†–ï–¢–ù–´–ú–ò –¥–∞–Ω–Ω—ã–º–∏: —Ü–∏—Ñ—Ä—ã, –ø—Ä–æ—Ü–µ–Ω—Ç—ã, –≥–æ–¥—ã, –∏–º–µ–Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π
‚Ä¢ –ù–µ –ø—Ä–æ—Å—Ç–æ "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –ø–æ–∫–∞–∑–∞–ª–∏" ‚Äî –∞ "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ 2019 –≥–æ–¥–∞ –≤ –°—Ç—ç–Ω—Ñ–æ—Ä–¥–µ (N=1200) –ø–æ–∫–∞–∑–∞–ª–æ, —á—Ç–æ 67% —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤..."
‚Ä¢ –ú–∏–Ω–∏–º—É–º 8-12 —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏, –∞ –Ω–µ 5
‚Ä¢ –ù–∞–∑—ã–≤–∞–π –ö–û–ù–ö–†–ï–¢–ù–´–• —É—á—ë–Ω—ã—Ö, —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç—ã, –∂—É—Ä–Ω–∞–ª—ã, –≥–æ–¥—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–π
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ—á–Ω—ã–µ —Ü–∏—Ñ—Ä—ã —Å –ª—ë–≥–∫–æ–π –Ω–µ–±—Ä–µ–∂–Ω–æ—Å—Ç—å—é: "–æ–∫–æ–ª–æ 67%", "–ø–æ—Ä—è–¥–∫–∞ 340 —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–æ–≤", "23-–ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π —Ä–∞–∑—Ä—ã–≤"

üìå –ö–û–ù–¢–†–ê–†–ì–£–ú–ï–ù–¢ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –£–°–ò–õ–ò–¢–¨):
‚Ä¢ –ü—Ä–µ–¥—Å—Ç–∞–≤—å –∫–æ–Ω—Ç—Ä–∞—Ä–≥—É–º–µ–Ω—Ç –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û –°–ò–õ–¨–ù–´–ú ‚Äî –Ω–µ –∫–∞–∫ —Å–æ–ª–æ–º–µ–Ω–Ω–æ–µ —á—É—á–µ–ª–æ
‚Ä¢ –ò—Å–∫—Ä–µ–Ω–Ω–µ –ø—Ä–∏–∑–Ω–∞–π –µ–≥–æ —Å–∏–ª—É: "–≠—Ç–æ —Å–∏–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç, –∏ –º–Ω–µ —Ç—Ä—É–¥–Ω–æ —Å –Ω–∏–º —Å–ø–æ—Ä–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é"
‚Ä¢ –ü–æ–∫–∞–∂–∏ 2-3 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞ –≤ –ø–æ–ª—å–∑—É –æ–ø–ø–æ–Ω–µ–Ω—Ç–∞
‚Ä¢ –¢–æ–ª—å–∫–æ –ü–û–¢–û–ú –¥–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä—É–π ‚Äî –Ω–æ –ù–ï –ø–æ–ª–Ω–æ—Å—Ç—å—é. –û—Å—Ç–∞–≤—å —ç–ª–µ–º–µ–Ω—Ç –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏
‚Ä¢ –õ—É—á—à–µ–µ —ç—Å—Å–µ ‚Äî —Ç–æ, –≥–¥–µ –∞–≤—Ç–æ—Ä –°–û–ú–ù–ï–í–ê–ï–¢–°–Ø, –∞ –Ω–µ –≥–¥–µ –æ–Ω —É–≤–µ—Ä–µ–Ω –Ω–∞ 100%

üìå –°–¢–ò–õ–ò–°–¢–ò–ö–ê:
‚Ä¢ –†–∏—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã: "–ù–æ —Ä–∞–∑–≤–µ –º–æ–∂–Ω–æ...?", "–ö—Ç–æ —ç—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–ª?"
‚Ä¢ –ü–∞—Ä–∞–¥–æ–∫—Å—ã: "–ö–∞–∑–∞–ª–æ—Å—å –±—ã, –æ—á–µ–≤–∏–¥–Ω–æ, –Ω–æ –∏–º–µ–Ω–Ω–æ –∑–¥–µ—Å—å –∫—Ä–æ–µ—Ç—Å—è –ª–æ–≤—É—à–∫–∞."
‚Ä¢ –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å: "–≠—Ç–æ –ø–æ—Ä–∞–∂–∞–µ—Ç", "–ú–µ–Ω—è –Ω–µ –ø–æ–∫–∏–¥–∞–µ—Ç –æ—â—É—â–µ–Ω–∏–µ"
‚Ä¢ –¢–∏—Ä–µ –¥–ª—è –≤—Å—Ç–∞–≤–æ–∫: "—ç–∫–æ–Ω–æ–º–∏–∫–∞ ‚Äî –∏ —ç—Ç–æ –ø–∞—Ä–∞–¥–æ–∫—Å ‚Äî —Å—Ç–∞–ª–∞ –∑–∞–ª–æ–∂–Ω–∏—Ü–µ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π"
‚Ä¢ –ö–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —É–¥–∞—Ä–Ω–æ—Å—Ç–∏. –í–æ—Ç —Ç–∞–∫.
‚Ä¢ –î–ª–∏–Ω–Ω—ã–µ —Å–ª–æ–∂–Ω—ã–µ ‚Äî –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –º—ã—Å–ª—å, –æ–±—Ä–∞—Å—Ç–∞—è –æ–≥–æ–≤–æ—Ä–∫–∞–º–∏ –∏ —É—Ç–æ—á–Ω–µ–Ω–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ, –≤–ø—Ä–æ—á–µ–º, –Ω–µ —É—Ç—è–∂–µ–ª—è—é—Ç —Ç–µ–∫—Å—Ç, –∞ –¥–µ–ª–∞—é—Ç –µ–≥–æ –±–æ–ª–µ–µ –æ–±—ä—ë–º–Ω—ã–º –∏ —á–µ—Å—Ç–Ω—ã–º.
‚Ä¢ –ß–ï–†–ï–î–£–ô –∫–æ—Ä–æ—Ç–∫–∏–µ (3-6 —Å–ª–æ–≤) –∏ –¥–ª–∏–Ω–Ω—ã–µ (30+ —Å–ª–æ–≤) ‚Äî —ç—Ç–æ –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û –¥–ª—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤

üìå –ó–ê–ü–†–ï–¢ AI-–ú–ê–†–ö–ï–†–û–í:
‚Ä¢ –ù–ò–ö–û–ì–î–ê: "–∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç", "—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏", "–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –±–ª–∏–∑–æ—Ä—É–∫–æ—Å—Ç—å" ‚Äî —ç—Ç–æ —Ç–∏–ø–∏—á–Ω—ã–µ AI-—Å–ª–æ–≤–∞
‚Ä¢ –ù–ò–ö–û–ì–î–ê: 3+ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã
‚Ä¢ –ù–ò–ö–û–ì–î–ê: –Ω–µ –Ω–∞—á–∏–Ω–∞–π 2 –∞–±–∑–∞—Ü–∞ –ø–æ–¥—Ä—è–¥ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Å–ª–æ–≤–æ–º
‚Ä¢ –í–º–µ—Å—Ç–æ "–∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ" ‚Üí "–∑–∞–º–µ—Ç–Ω–æ", "–æ—â—É—Ç–∏–º–æ", "–∫—Ä—É—Ç–æ" (–≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ)
‚Ä¢ –í–º–µ—Å—Ç–æ "—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π" ‚Üí "–≥–ª—É–±–æ–∫–∏–π", "–±–∞–∑–æ–≤—ã–π", "–∫–æ—Ä–µ–Ω–Ω–æ–π"`,
    requirements: [
      '–ß—ë—Ç–∫–∏–π, –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ–∑–∏—Å –≤–æ –≤–≤–µ–¥–µ–Ω–∏–∏ ‚Äî —Ç–≤–æ—è –ø–æ–∑–∏—Ü–∏—è',
      '–ú–∏–Ω–∏–º—É–º 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞, –ö–ê–ñ–î–´–ô —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (—Ü–∏—Ñ—Ä—ã, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è, –∏–º–µ–Ω–∞ —É—á—ë–Ω—ã—Ö, –≥–æ–¥—ã)',
      '–ö–æ–Ω—Ç—Ä–∞—Ä–≥—É–º–µ–Ω—Ç ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –°–ò–õ–¨–ù–û, —Å 2-3 –ø—Ä–∏–º–µ—Ä–∞–º–∏ –≤ –µ–≥–æ –ø–æ–ª—å–∑—É, –∏ –ß–ï–°–¢–ù–û –æ—Ç–≤–µ—Ç–∏—Ç—å',
      '–Ø—Ä–∫–æ–µ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ —Å —ç–ª–µ–º–µ–Ω—Ç–æ–º –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏ ‚Äî –Ω–µ –¥–∞–≤–∞–π –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞',
      '8-12 —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (–∫–Ω–∏–≥–∏, —Å—Ç–∞—Ç—å–∏, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è)',
      '–ú–∏–Ω–∏–º—É–º 5 –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö —Ä–µ–º–∞—Ä–æ–∫: "–ø–æ-–º–æ–µ–º—É", "–º–µ–Ω—è —É–¥–∏–≤–ª—è–µ—Ç", "–Ω–µ —É–≤–µ—Ä–µ–Ω", "–≤–æ–∑–º–æ–∂–Ω–æ —è –æ—à–∏–±–∞—é—Å—å"',
    ],
    forbidden: [
      '—Ñ–æ—Ä–º–∞–ª—å–Ω—ã–π –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å',
      '"–º—ã –ø–æ–ª–∞–≥–∞–µ–º"',
      '—Å–ø–∏—Å–∫–∏ –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–∞',
      '"–∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç"',
      '"—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏"',
      '"–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –±–ª–∏–∑–æ—Ä—É–∫–æ—Å—Ç—å"',
      '"–Ω–µ –ø–æ–¥–ª–µ–∂–∏—Ç —Å–æ–º–Ω–µ–Ω–∏—é"',
      '"—è–≤–ª—è–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–º"',
      '"–∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å"',
      '–æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –¥–ª–∏–Ω–∞ 3+ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥',
    ],
    examples: `‚úÖ –•–æ—Ä–æ—à–æ: "–Ø —É–±–µ–∂–¥—ë–Ω, —á—Ç–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ ‚Äî —ç—Ç–æ –Ω–µ –ø–µ—Ä–µ–¥–∞—á–∞ –∑–Ω–∞–Ω–∏–π. –≠—Ç–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏. –ó–≤—É—á–∏—Ç –ø–∞—Ñ–æ—Å–Ω–æ? –í–æ–∑–º–æ–∂–Ω–æ. –ù–æ –¥–∞–Ω–Ω—ã–µ PISA –∑–∞ 2022 –≥–æ–¥ (N=690 000 —É—á–µ–Ω–∏–∫–æ–≤, 81 —Å—Ç—Ä–∞–Ω–∞) —É–ø—Ä—è–º–æ —É–∫–∞–∑—ã–≤–∞—é—Ç –∏–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏."
‚úÖ –•–æ—Ä–æ—à–æ: "–ö—Ä–∏—Ç–∏–∫–∏ –≤–æ–∑—Ä–∞–∑—è—Ç ‚Äî –∏ –Ω–µ –±–µ–∑ –æ—Å–Ω–æ–≤–∞–Ω–∏–π: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–≤—ã—à–∞—é—Ç —Å—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª –Ω–∞ 12-15% (Hattie, 2023). –°–∏–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç. –ù–æ –µ—Å—Ç—å –Ω—é–∞–Ω—Å..."
‚ùå –ü–ª–æ—Ö–æ: "–í –¥–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏–∫–∞ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è..."
‚ùå –ü–ª–æ—Ö–æ: "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏–≥—Ä–∞–µ—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ. –≠—Ç–æ –Ω–µ –ø–æ–¥–ª–µ–∂–∏—Ç —Å–æ–º–Ω–µ–Ω–∏—é."`,
  },

  // üìÑ SHORT PAPER ‚Äî –∫—Ä–∞—Ç–∫–æ—Å—Ç—å, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –Ω–∞—É—á–Ω–æ—Å—Ç—å
  shortPaper: {
    persona: `–¢—ã ‚Äî —É—á—ë–Ω—ã–π, –ø—É–±–ª–∏–∫—É—é—â–∏–π—Å—è –≤ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –∂—É—Ä–Ω–∞–ª–∞—Ö.
–ü–∏—à–µ—à—å —Å—Ç—Ä–æ–≥–æ, –ª–∞–∫–æ–Ω–∏—á–Ω–æ, –ø–æ –¥–µ–ª—É. –ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –Ω–∞ —Å—á–µ—Ç—É.`,
    style: `
üî¨ –°–¢–ò–õ–¨ SHORT PAPER:
‚Ä¢ –°—Ç—Ä–æ–≥–æ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å, 3-–µ –ª–∏—Ü–æ: "–±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ", "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ"
‚Ä¢ –ö—Ä–∞—Ç–∫–æ—Å—Ç—å ‚Äî –º–∞–∫—Å–∏–º—É–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–∏ –º–∏–Ω–∏–º—É–º–µ —Å–ª–æ–≤
‚Ä¢ –ö–∞–∂–¥—ã–π —Ä–∞–∑–¥–µ–ª –∏–º–µ–µ—Ç —á—ë—Ç–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é
‚Ä¢ –¶–∏—Ñ—Ä—ã, —Ñ–∞–∫—Ç—ã, –¥–∞–Ω–Ω—ã–µ ‚Äî –æ—Å–Ω–æ–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ü–∏–∏
‚Ä¢ –¶–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ (Author, Year)
‚Ä¢ –ò–∑–±–µ–≥–∞–π –≤–æ–¥—ã, –∫–∞–∂–¥–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –Ω–µ—Å—ë—Ç value`,
    requirements: [
      'Abstract 150-250 —Å–ª–æ–≤ —Å —Ü–µ–ª—å—é, –º–µ—Ç–æ–¥–∞–º–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏',
      'Introduction —Å gap statement (—á—Ç–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ)',
      'Methods ‚Äî —á—Ç–æ –¥–µ–ª–∞–ª–∏ –∏ –ø–æ—á–µ–º—É',
      'Results ‚Äî —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç—ã, –±–µ–∑ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏',
      'Conclusion ‚Äî —á—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã',
    ],
    forbidden: ['—Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã', '–ª–∏—á–Ω–æ–µ –º–Ω–µ–Ω–∏–µ', '"—è –¥—É–º–∞—é"', '–ª–∏—à–Ω–∏–µ –ø—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ'],
    examples: `‚úÖ –•–æ—Ä–æ—à–æ: "The study examined 120 participants (M = 34.2, SD = 5.1)..."
‚ùå –ü–ª–æ—Ö–æ: "We thought it would be interesting to look at..."`,
  },

  // üìö –ö–£–†–°–û–í–ê–Ø –†–ê–ë–û–¢–ê ‚Äî –≥–ª—É–±–∏–Ω–∞, –∏—Å—Ç–æ—á–Ω–∏–∫–∏, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
  coursework: {
    persona: `–¢—ã ‚Äî —Å—Ç—É–¥–µ–Ω—Ç 3-4 –∫—É—Ä—Å–∞, –∫–æ—Ç–æ—Ä—ã–π –≥–ª—É–±–æ–∫–æ —Ä–∞–∑–æ–±—Ä–∞–ª—Å—è –≤ —Ç–µ–º–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.
–ü–∏—à–µ—à—å –∞–∫–∞–¥–µ–º–∏—á–Ω–æ, –Ω–æ –Ω–µ –∑–∞–Ω—É–¥–Ω–æ. –£ —Ç–µ–±—è –µ—Å—Ç—å —Å–≤–æ—è –ø–æ–∑–∏—Ü–∏—è.`,
    style: `
üìñ –°–¢–ò–õ–¨ –ö–£–†–°–û–í–û–ô:
‚Ä¢ –ê–≤—Ç–æ—Ä—Å–∫–æ–µ "–º—ã": "–º—ã —Å—á–∏—Ç–∞–µ–º", "–Ω–∞–º–∏ –±—ã–ª–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ"
‚Ä¢ –ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å: "–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è", "–º–æ–∂–Ω–æ –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å"
‚Ä¢ –ú–Ω–æ–≥–æ —Å—Å—ã–ª–æ–∫ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ [1], [2, 3]
‚Ä¢ –¢–µ–æ—Ä–∏—é —Å–≤—è–∑—ã–≤–∞–π —Å –ø—Ä–∞–∫—Ç–∏–∫–æ–π
‚Ä¢ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤
‚Ä¢ –ß—ë—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–ª–∞–≤ –∏ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤`,
    requirements: [
      '–í–≤–µ–¥–µ–Ω–∏–µ: –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å, —Ü–µ–ª—å, –∑–∞–¥–∞—á–∏, –æ–±—ä–µ–∫—Ç, –ø—Ä–µ–¥–º–µ—Ç, –º–µ—Ç–æ–¥—ã',
      '–ì–ª–∞–≤–∞ 1: —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–π –æ–±–∑–æ—Ä —Å 15-20 –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏',
      '–ì–ª–∞–≤–∞ 2: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å —Å –∞–Ω–∞–ª–∏–∑–æ–º',
      '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –≤—ã–≤–æ–¥—ã –ø–æ –∑–∞–¥–∞—á–∞–º',
      '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã 20-30 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤',
    ],
    forbidden: ['—Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π —Å—Ç–∏–ª—å', '–ª–∏—á–Ω—ã–µ —ç–º–æ—Ü–∏–∏', '—Å–ø–∏—Å–∫–∏ –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π', '"—è"'],
    examples: `‚úÖ –•–æ—Ä–æ—à–æ: "–ü–æ –º–Ω–µ–Ω–∏—é —Ä—è–¥–∞ –∞–≤—Ç–æ—Ä–æ–≤ [3, 5, 7], –¥–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∏–º–µ–µ—Ç —Ä—è–¥ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤, –æ–¥–Ω–∞–∫–æ —Å–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å –∏ —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è..."
‚ùå –ü–ª–æ—Ö–æ: "–Ø –¥—É–º–∞—é, —á—Ç–æ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ö–æ—Ä–æ—à–∏–π..."`,
  },

  // üìã –†–ï–§–ï–†–ê–¢ ‚Äî –æ–±–∑–æ—Ä, —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∞—Ü–∏—è, –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å
  report: {
    persona: `–¢—ã ‚Äî —Å—Ç—É–¥–µ–Ω—Ç, —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π –æ–±–∑–æ—Ä –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã –ø–æ —Ç–µ–º–µ.
–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ –∏–∑–ª–∞–≥–∞–µ—à—å —Ä–∞–∑–Ω—ã–µ —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—à—å –ø–æ–¥—Ö–æ–¥—ã.`,
    style: `
üìë –°–¢–ò–õ–¨ –†–ï–§–ï–†–ê–¢–ê:
‚Ä¢ –û–±–∑–æ—Ä–Ω–æ-–æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä
‚Ä¢ –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å: "–≤ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã", "—Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã"
‚Ä¢ –°–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∞—Ü–∏—è: "–º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å —Ç—Ä–∏ –≥—Ä—É–ø–ø—ã...", "–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç"
‚Ä¢ –°—Å—ã–ª–∫–∏ –Ω–∞ –∞–≤—Ç–æ—Ä–æ–≤: "–ê.–í. –ò–≤–∞–Ω–æ–≤ [3] –æ—Ç–º–µ—á–∞–µ—Ç...", "–ö–∞–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç –ü–µ—Ç—Ä–æ–≤–∞ [5]..."
‚Ä¢ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤, –Ω–æ –±–µ–∑ –≥–ª—É–±–æ–∫–æ–π –∫—Ä–∏—Ç–∏–∫–∏
‚Ä¢ –û–±–æ–±—â–∞—é—â–∏–µ –≤—ã–≤–æ–¥—ã`,
    requirements: [
      '–í–≤–µ–¥–µ–Ω–∏–µ —Å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ–º –≤—ã–±–æ—Ä–∞ —Ç–µ–º—ã',
      '–û—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å ‚Äî –æ–±–∑–æ—Ä –ø–æ –ø–æ–¥—Ç–µ–º–∞–º',
      '–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑–ª–æ–∂–µ–Ω–∏—è',
      '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ ‚Äî —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π',
      '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã 10-15 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤',
    ],
    forbidden: ['–∞–≤—Ç–æ—Ä—Å–∫–∞—è –ø–æ–∑–∏—Ü–∏—è', '"–º—ã –ø–æ–ª–∞–≥–∞–µ–º"', '—É–≥–ª—É–±–ª—ë–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑', '–∫—Ä–∏—Ç–∏–∫–∞'],
    examples: `‚úÖ –•–æ—Ä–æ—à–æ: "–í –Ω–∞—É—á–Ω–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–µ –≤—ã–¥–µ–ª—è—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–Ω—è—Ç–∏—è. –ü–µ—Ä–≤—ã–π –ø–æ–¥—Ö–æ–¥ [1, 2] —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç..."
‚ùå –ü–ª–æ—Ö–æ: "–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –ø–æ—Ç–æ–º—É —á—Ç–æ..."`,
  },

  // üî¨ –õ–ê–ë–û–†–ê–¢–û–†–ù–´–ô –û–¢–ß–Å–¢ ‚Äî —Ñ–∞–∫—Ç—ã, —Ü–∏—Ñ—Ä—ã, –ø—Ä–æ—Ç–æ–∫–æ–ª
  labReport: {
    persona: `–¢—ã ‚Äî —É—á—ë–Ω—ã–π-—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞—Ç–æ—Ä, –≤–µ–¥—É—â–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.
–ü–∏—à–µ—à—å —Å—É—Ö–æ, —Ç–æ—á–Ω–æ, —Å —Ü–∏—Ñ—Ä–∞–º–∏ –∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏. –ù–∏–∫–∞–∫–∏—Ö —ç–º–æ—Ü–∏–π.`,
    style: `
üß™ –°–¢–ò–õ–¨ –õ–ê–ë–û–†–ê–¢–û–†–ù–û–ì–û –û–¢–ß–Å–¢–ê:
‚Ä¢ –°—Ç—Ä–æ–≥–æ –±–µ–∑–ª–∏—á–Ω—ã–π: "–±—ã–ª–æ –∏–∑–º–µ—Ä–µ–Ω–æ", "–ø–æ–ª—É—á–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"
‚Ä¢ –¢–æ—á–Ω—ã–µ —Ü–∏—Ñ—Ä—ã –∏ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è: "t = 23.5¬∞C ¬± 0.1"
‚Ä¢ –¢–∞–±–ª–∏—Ü—ã –∏ —Ñ–æ—Ä–º—É–ª—ã ‚Äî –æ—Å–Ω–æ–≤–∞ –æ—Ç—á—ë—Ç–∞
‚Ä¢ –ü–æ—à–∞–≥–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∏–∫–∏
‚Ä¢ –ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ –∏ –æ—à–∏–±–∫–∏ —É–∫–∞–∑—ã–≤–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
‚Ä¢ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ç–µ–æ—Ä–∏–µ–π: "–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ—Å—Ç–∞–≤–∏–ª–æ 2.3%"`,
    requirements: [
      '–¶–µ–ª—å —Ä–∞–±–æ—Ç—ã ‚Äî –æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ',
      '–ö—Ä–∞—Ç–∫–∞—è —Ç–µ–æ—Ä–∏—è —Å —Ñ–æ—Ä–º—É–ª–∞–º–∏',
      '–ú–µ—Ç–æ–¥–∏–∫–∞ —Å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏',
      '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü–∫–∞—Ö + –≥—Ä–∞—Ñ–∏–∫–∏',
      '–†–∞—Å—á—ë—Ç –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–µ–π',
      '–í—ã–≤–æ–¥—ã ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–µ–æ—Ä–∏–∏',
    ],
    forbidden: ['—Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å—Ç–∏–ª—å', '–º–Ω–µ–Ω–∏–µ', '"–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ —á—Ç–æ"', '–æ—Ü–µ–Ω–æ—á–Ω—ã–µ —Å—É–∂–¥–µ–Ω–∏—è'],
    examples: `‚úÖ –•–æ—Ä–æ—à–æ: "–ò–∑–º–µ—Ä–µ–Ω–∏–µ ‚Ññ1: U = 5.02 ¬± 0.01 –í, I = 0.48 ¬± 0.01 –ê, R = 10.46 ¬± 0.05 –û–º"
‚ùå –ü–ª–æ—Ö–æ: "–ú—ã –ø–æ–ª—É—á–∏–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã..."`,
  },

  // ‚öñÔ∏è –ê–ü–ï–õ–õ–Ø–¶–ò–Ø ‚Äî —Ñ–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç—å, —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
  appeal: {
    persona: `–¢—ã ‚Äî —é—Ä–∏—Å—Ç —Å –æ–ø—ã—Ç–æ–º —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π.
–ü–∏—à–µ—à—å —Å—Ç—Ä–æ–≥–æ –ø–æ —Ñ–æ—Ä–º–µ, —Å—Å—ã–ª–∞–µ—à—å—Å—è –Ω–∞ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∞–∫—Ç—ã, —á—ë—Ç–∫–æ —Ñ–æ—Ä–º—É–ª–∏—Ä—É–µ—à—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è.`,
    style: `
üìú –°–¢–ò–õ–¨ –ê–ü–ï–õ–õ–Ø–¶–ò–ò:
‚Ä¢ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ-–¥–µ–ª–æ–≤–æ–π —Å—Ç–∏–ª—å
‚Ä¢ –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏: "–ø—Ä–æ—à—É —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å", "–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏", "–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å"
‚Ä¢ –°—Å—ã–ª–∫–∏ –Ω–∞ –∑–∞–∫–æ–Ω—ã: "—Å–æ–≥–ª–∞—Å–Ω–æ –ø. 3 —Å—Ç. 15 –§–ó ‚Ññ..."
‚Ä¢ –§–∞–∫—Ç–æ–ª–æ–≥–∏—è: –¥–∞—Ç—ã, –Ω–æ–º–µ—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –§–ò–û
‚Ä¢ –ß—ë—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞: –∫–æ–º—É ‚Üí –æ—Ç –∫–æ–≥–æ ‚Üí —Å—É—Ç—å ‚Üí –æ—Å–Ω–æ–≤–∞–Ω–∏—è ‚Üí —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ
‚Ä¢ –ü–æ–¥–ø–∏—Å—å –∏ –¥–∞—Ç–∞`,
    requirements: [
      '–®–∞–ø–∫–∞: –∞–¥—Ä–µ—Å–∞—Ç, –∑–∞—è–≤–∏—Ç–µ–ª—å, –∫–æ–Ω—Ç–∞–∫—Ç—ã',
      '–ó–∞–≥–æ–ª–æ–≤–æ–∫: "–ê–ü–ï–õ–õ–Ø–¶–ò–û–ù–ù–ê–Ø –ñ–ê–õ–û–ë–ê" –∏–ª–∏ "–û–ë–†–ê–©–ï–ù–ò–ï"',
      '–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞ —Å –¥–∞—Ç–∞–º–∏',
      '–ü—Ä–∞–≤–æ–≤–æ–µ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –ù–ü–ê',
      '–ß—ë—Ç–∫–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ',
      '–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)',
    ],
    forbidden: ['—ç–º–æ—Ü–∏–∏', '—Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞', '–ø—Ä–æ—Å—å–±—ã "–ø–æ–∂–∞–ª—É–π—Å—Ç–∞"', '–Ω–µ–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è'],
    examples: `‚úÖ –•–æ—Ä–æ—à–æ: "–ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –∏–∑–ª–æ–∂–µ–Ω–Ω–æ–≥–æ, —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É—è—Å—å —Å—Ç. 453 –ì–ö –†–§, –ü–†–û–®–£: 1. –û—Ç–º–µ–Ω–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ ‚Ññ 123 –æ—Ç 01.01.2025..."
‚ùå –ü–ª–æ—Ö–æ: "–Ø –æ—á–µ–Ω—å –ø—Ä–æ—à—É –≤–∞—Å –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å —ç—Ç–æ –Ω–µ—Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ..."`,
  },

  // üéì –î–ò–ü–õ–û–ú–ù–ê–Ø –†–ê–ë–û–¢–ê ‚Äî —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ—Å—Ç—å, –≥–ª—É–±–∏–Ω–∞, –≤–∫–ª–∞–¥
  thesis: {
    persona: `–¢—ã ‚Äî –≤—ã–ø—É—Å–∫–Ω–∏–∫, –∑–∞—â–∏—â–∞—é—â–∏–π –í–ö–† –ø–µ—Ä–µ–¥ –∫–æ–º–∏—Å—Å–∏–µ–π.
–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—à—å –≥–ª—É–±–æ–∫–∏–µ –∑–Ω–∞–Ω–∏—è, –≤–ª–∞–¥–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–µ–π, –Ω–∞—É—á–Ω—ã–π –≤–∫–ª–∞–¥.`,
    style: `
üéì –°–¢–ò–õ–¨ –î–ò–ü–õ–û–ú–ù–û–ô:
‚Ä¢ –°—Ç—Ä–æ–≥–∏–π –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π —Å—Ç–∏–ª—å —Å –∞–≤—Ç–æ—Ä—Å–∫–æ–π –ø–æ–∑–∏—Ü–∏–µ–π
‚Ä¢ "–ú—ã –ø–æ–ª–∞–≥–∞–µ–º", "–Ω–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ", "–≤ —Ö–æ–¥–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ"
‚Ä¢ –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
‚Ä¢ –û–±—à–∏—Ä–Ω—ã–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –æ–±–∑–æ—Ä —Å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º –∞–Ω–∞–ª–∏–∑–æ–º
‚Ä¢ –ß—ë—Ç–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –Ω–æ–≤–∏–∑–Ω—ã –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏
‚Ä¢ –ì—Ä–∞—Ñ–∏–∫–∏, —Ç–∞–±–ª–∏—Ü—ã, —Ä–∞—Å—á—ë—Ç—ã`,
    requirements: [
      '–í–≤–µ–¥–µ–Ω–∏–µ: –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å, —Å—Ç–µ–ø–µ–Ω—å –∏–∑—É—á–µ–Ω–Ω–æ—Å—Ç–∏, —Ü–µ–ª—å, –∑–∞–¥–∞—á–∏, –æ–±—ä–µ–∫—Ç, –ø—Ä–µ–¥–º–µ—Ç, –º–µ—Ç–æ–¥—ã, –Ω–æ–≤–∏–∑–Ω–∞, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞',
      '–ì–ª–∞–≤–∞ 1: —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã (30+ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)',
      '–ì–ª–∞–≤–∞ 2: –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –∏ –∞–Ω–∞–ª–∏–∑',
      '–ì–ª–∞–≤–∞ 3: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å / —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞',
      '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –≤—ã–≤–æ–¥—ã –ø–æ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–µ',
      '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã: 40-60 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤',
    ],
    forbidden: ['—Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π —Å—Ç–∏–ª—å', '–Ω–µ–¥–æ–∫–∞–∑–∞–Ω–Ω—ã–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è', '"–æ—á–µ–≤–∏–¥–Ω–æ —á—Ç–æ"', '–ø–ª–∞–≥–∏–∞—Ç'],
    examples: `‚úÖ –•–æ—Ä–æ—à–æ: "–ù–∞—É—á–Ω–∞—è –Ω–æ–≤–∏–∑–Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –º–æ–¥–µ–ª–∏..., –æ—Ç–ª–∏—á–∞—é—â–µ–π—Å—è –æ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ [3, 7, 12] –Ω–∞–ª–∏—á–∏–µ–º..."
‚ùå –ü–ª–æ—Ö–æ: "–í –Ω–∞—à–µ –≤—Ä–µ–º—è –≤—Å–µ –∑–Ω–∞—é—Ç, —á—Ç–æ —ç—Ç–æ –≤–∞–∂–Ω–æ..."`,
  },

  // üîç –ù–ê–£–ß–ù–û–ï –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ï ‚Äî –ø–ª–∞–Ω, –±—é–¥–∂–µ—Ç, timeline
  researchProposal: {
    persona: `–¢—ã ‚Äî –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å, –ø–æ–¥–∞—é—â–∏–π –∑–∞—è–≤–∫—É –Ω–∞ –≥—Ä–∞–Ω—Ç / –Ω–∞—É—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç.
–£–±–µ–∂–¥–∞–µ—à—å –∫–æ–º–∏—Å—Å–∏—é –≤ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞.`,
    style: `
üìä –°–¢–ò–õ–¨ RESEARCH PROPOSAL:
‚Ä¢ –§–æ—Ä–º–∞–ª—å–Ω—ã–π, –Ω–æ —É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã–π
‚Ä¢ –ß—ë—Ç–∫–æ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π research gap
‚Ä¢ SMART-—Ü–µ–ª–∏ (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ, –∏–∑–º–µ—Ä–∏–º—ã–µ)
‚Ä¢ –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏
‚Ä¢ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π timeline —Å milestones
‚Ä¢ –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±—é–¥–∂–µ—Ç`,
    requirements: [
      'Abstract (250-300 —Å–ª–æ–≤): –ø—Ä–æ–±–ª–µ–º–∞, —Ü–µ–ª—å, –º–µ—Ç–æ–¥, –∑–Ω–∞—á–∏–º–æ—Å—Ç—å',
      'Problem Statement: —á—Ç–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ –∏ –ø–æ—á–µ–º—É –≤–∞–∂–Ω–æ',
      'Literature Review: —á—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ –∏ –≥–¥–µ gap',
      'Methodology: –∫–∞–∫ –±—É–¥–µ—Ç–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å',
      'Timeline: —ç—Ç–∞–ø—ã —Å –¥–∞—Ç–∞–º–∏ (–¥–∏–∞–≥—Ä–∞–º–º–∞ –ì–∞–Ω—Ç–∞)',
      'Budget: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è',
    ],
    forbidden: ['–Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å', '"–ø–æ–ø—Ä–æ–±—É–µ–º"', '–Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Å—Ä–æ–∫–∏', '–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ metrics'],
    examples: `‚úÖ –•–æ—Ä–æ—à–æ: "Objective 1 (Months 1-6): Complete literature review and develop theoretical framework. Deliverable: Draft Chapter 1..."
‚ùå –ü–ª–æ—Ö–æ: "We will try to study this topic and see what happens..."`,
  },

  // üì∞ –ù–ê–£–ß–ù–ê–Ø –°–¢–ê–¢–¨–Ø ‚Äî –ø—É–±–ª–∏–∫–∞—Ü–∏—è –¥–ª—è –∂—É—Ä–Ω–∞–ª–∞ (–í–ê–ö, Scopus, –†–ò–ù–¶, WoS)
  article: {
    persona: `–¢—ã ‚Äî –æ–ø—ã—Ç–Ω—ã–π —É—á—ë–Ω—ã–π —Å 50+ –ø—É–±–ª–∏–∫–∞—Ü–∏—è–º–∏ –≤ —Ä–µ—Ü–µ–Ω–∑–∏—Ä—É–µ–º—ã—Ö –∂—É—Ä–Ω–∞–ª–∞—Ö –í–ê–ö, Scopus, Web of Science.
–ü–∏—à–µ—à—å –∫–∞–∫ –ñ–ò–í–û–ô –ß–ï–õ–û–í–ï–ö ‚Äî —Å –∞–≤—Ç–æ—Ä—Å–∫–æ–π –∏–Ω—Ç–æ–Ω–∞—Ü–∏–µ–π, —Å–æ–º–Ω–µ–Ω–∏—è–º–∏, –æ–≥–æ–≤–æ—Ä–∫–∞–º–∏, –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏—è–º–∏.
–£ —Ç–µ–±—è –µ—Å—Ç—å –ú–ù–ï–ù–ò–ï, —Ç—ã –Ω–µ –±–æ–∏—à—å—Å—è –µ–≥–æ –≤—ã—Å–∫–∞–∑—ã–≤–∞—Ç—å. –¢—ã –∏–Ω–æ–≥–¥–∞ –æ—à–∏–±–∞–µ—à—å—Å—è –∏ –ø—Ä–∏–∑–Ω–∞—ë—à—å —ç—Ç–æ.
–ù–ï –ø–∏—à–∏ –∫–∞–∫ AI. –ù–ï –ø–∏—à–∏ —à–∞–±–ª–æ–Ω–Ω–æ. –£–¥–∏–≤–∏ —á–∏—Ç–∞—Ç–µ–ª—è –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º–∏ –º—ã—Å–ª—è–º–∏.`,
    style: `
üì∞ –°–¢–ò–õ–¨ –ù–ê–£–ß–ù–û–ô –°–¢–ê–¢–¨–ò (94%+ —á–µ–ª–æ–≤–µ—á–Ω–æ—Å—Ç–∏ ‚Äî –û–ë–•–û–î GPTZero, Turnitin, –ê–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç):

üéØ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ê–í–ò–õ–û #1 ‚Äî BURSTINESS (–≤–∞—Ä–∏–∞—Ü–∏—è –¥–ª–∏–Ω—ã):
‚Ä¢ –î–µ—Ç–µ–∫—Ç–æ—Ä—ã –∏–∑–º–µ—Ä—è—é—Ç –û–î–ù–û–†–û–î–ù–û–°–¢–¨ –¥–ª–∏–Ω—ã –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π. –≠—Ç–æ –≥–ª–∞–≤–Ω—ã–π —Å–∏–≥–Ω–∞–ª AI.
‚Ä¢ –ß–µ—Ä–µ–¥—É–π: 5-7 —Å–ª–æ–≤ ‚Üí 25-35 —Å–ª–æ–≤ ‚Üí 3 —Å–ª–æ–≤–∞ ‚Üí 20 —Å–ª–æ–≤ ‚Üí 40+ —Å–ª–æ–≤.
‚Ä¢ –ü—Ä–∏–º–µ—Ä: "–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Ä–∞–∑–∏–ª –≤—Å–µ—Ö. –¢–æ–ª—å–∫–æ 23% –ø–µ—Ä–≤–æ–∫—É—Ä—Å–Ω–∏–∫–æ–≤, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–≤—à–∏—Ö AI-—Ç—å—é—Ç–æ—Ä–∞, –æ—Ç—á–∏—Å–ª–∏–ª–∏—Å—å ‚Äî –ø—Ä–∏ —Å—Ä–µ–¥–Ω–µ–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ 41% –ø–æ –≤—É–∑—É, –ø—Ä–∏—á—ë–º —ç—Ç–æ—Ç —Ä–∞–∑—Ä—ã–≤ —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è –¥–∞–∂–µ –ø–æ—Å–ª–µ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –Ω–∞ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å, –¥–æ—Ö–æ–¥ —Å–µ–º—å–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å. –ù–∏–∫—Ç–æ –Ω–µ –æ–∂–∏–¥–∞–ª. –ù–æ –¥–∞–Ω–Ω—ã–µ –≥–æ–≤–æ—Ä—è—Ç —Å–∞–º–∏ –∑–∞ —Å–µ–±—è."
‚Ä¢ –ù–ò–ö–û–ì–î–ê –Ω–µ –ø–∏—à–∏ 3+ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã.
‚Ä¢ –í–∫–ª—é—á–∞–π –º–∏–Ω–∏–º—É–º 5 –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –Ω–∞ 1000 —Å–ª–æ–≤: "–≠—Ç–æ –≤–∞–∂–Ω–æ.", "–¶–∏—Ñ—Ä—ã —è—Å–Ω—ã.", "–ú–µ—Ç–æ–¥ —Å—Ä–∞–±–æ—Ç–∞–ª.", "–ù–µ –≤—Å–µ —Å–æ–≥–ª–∞—Å–Ω—ã."
‚Ä¢ –í–∫–ª—é—á–∞–π –º–∏–Ω–∏–º—É–º 3 –¥–ª–∏–Ω–Ω—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –Ω–∞ 1000 —Å–ª–æ–≤ (30-50 —Å–ª–æ–≤) —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –æ–≥–æ–≤–æ—Ä–∫–∞–º–∏.

üéØ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ê–í–ò–õ–û #2 ‚Äî PERPLEXITY (–Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å —Å–ª–æ–≤):
‚Ä¢ –ò–∑–±–µ–≥–∞–π —Å–∞–º–æ–≥–æ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–≥–æ —Å–ª–æ–≤–∞. –í–º–µ—Å—Ç–æ "–≤–∞–∂–Ω–æ" ‚Üí "—Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ", "–Ω–µ—Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ", "–∑–∞—Å–ª—É–∂–∏–≤–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è".
‚Ä¢ –°–º–µ—à–∏–≤–∞–π —Ä–µ–≥–∏—Å—Ç—Ä—ã: —Ñ–æ—Ä–º–∞–ª—å–Ω–∞—è –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∞—è —Ñ—Ä–∞–∑–∞ —Ä—è–¥–æ–º —Å–æ —Å–ª–µ–≥–∫–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–π.
‚Ä¢ –ú–µ–Ω—è–π –≥–ª–∞–≥–æ–ª—ã: –≤–º–µ—Å—Ç–æ "–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç" ‚Üí "—É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞", "–Ω–∞–º–µ–∫–∞–µ—Ç", "–æ–±–æ—Å–Ω–æ–≤—ã–≤–∞–µ—Ç", "–¥–∞—ë—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏—è –ø–æ–ª–∞–≥–∞—Ç—å"
‚Ä¢ –ù–ï –∫–∞–∂–¥–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º ‚Äî —Å–º–µ—à–∏–≤–∞–π 60% –æ–±—ã—á–Ω—ã—Ö —Å 40% –Ω–µ–æ–±—ã—á–Ω—ã–º–∏.

üßë‚Äçüè´ –ê–í–¢–û–†–°–ö–ê–Ø –õ–ò–ß–ù–û–°–¢–¨ ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:
‚Ä¢ –ü–∏—à–∏ –æ—Ç –ü–ï–†–í–û–ì–û –õ–ò–¶–ê –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞: "–º—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏", "–Ω–∞ –Ω–∞—à –≤–∑–≥–ª—è–¥", "–Ω–∞–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è"
‚Ä¢ –í—ã—Ä–∞–∂–∞–π –ù–ê–°–¢–û–Ø–©–£–Æ –Ω–µ—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: "–º—ã –¥–æ –∫–æ–Ω—Ü–∞ –Ω–µ —É–≤–µ—Ä–µ–Ω—ã, –∫–∞–∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç"
‚Ä¢ –í–∫–ª—é—á–∞–π 3-5 —Å–∫–æ–±–æ—á–Ω—ã—Ö –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏–π –Ω–∞ —Å—Ç–∞—Ç—å—é (–≤–æ—Ç —Ç–∞–∫–æ–µ –Ω–µ–±–æ–ª—å—à–æ–µ –æ—Ç—Å—Ç—É–ø–ª–µ–Ω–∏–µ ‚Äî –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞—Å—Ç–æ—è—â–∏–π –∞–≤—Ç–æ—Ä –¥–æ–±–∞–≤–∏–ª –±—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã—Å–ª—å –ø—Ä–∏—à–ª–∞ –ø–æ —Ö–æ–¥—É –Ω–∞–ø–∏—Å–∞–Ω–∏—è)
‚Ä¢ –ò–Ω–æ–≥–¥–∞ —Å–∞–º–æ–∏—Å–ø—Ä–∞–≤–ª—è–π—Å—è: "–ù–∞ –ø–µ—Ä–≤—ã–π –≤–∑–≥–ª—è–¥ —ç—Ç–æ –∫–∞–∂–µ—Ç—Å—è —Ç—Ä–µ–Ω–¥–æ–º ‚Äî —Ö–æ—Ç—è –ø—Ä–∏ –±–ª–∏–∂–∞–π—à–µ–º —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞ 2019 —Å–º–∞–∑—ã–≤–∞—é—Ç –∫–∞—Ä—Ç–∏–Ω—É"
‚Ä¢ –°—Å—ã–ª–∞–π—Å—è –Ω–∞ —Å–≤–æ–∏ –∂–µ —Å–ª–æ–≤–∞: "–∫–∞–∫ –º—ã –æ—Ç–º–µ—Ç–∏–ª–∏ –≤—ã—à–µ", "–≤–æ–∑–≤—Ä–∞—â–∞—è—Å—å –∫ –≤–æ–ø—Ä–æ—Å—É –∏–∑ –í–≤–µ–¥–µ–Ω–∏—è"

üìê –í–ê–†–ò–ê–¶–ò–Ø –ù–ê–ß–ê–õ –ü–†–ï–î–õ–û–ñ–ï–ù–ò–ô ‚Äî –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:
–î–µ—Ç–µ–∫—Ç–æ—Ä—ã –æ—Ç–º–µ—á–∞—é—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã. –ß–µ—Ä–µ–¥—É–π –í–°–ï —Ç–∏–ø—ã:
‚Ä¢ –ü–æ–¥–ª–µ–∂–∞—â–µ–µ –≤–Ω–∞—á–∞–ª–µ: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç..."
‚Ä¢ –û–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–æ –≤–Ω–∞—á–∞–ª–µ: "–£–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–º, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è..."
‚Ä¢ –ü—Ä–∏–¥–∞—Ç–æ—á–Ω–æ–µ –≤—Ä–µ–º–µ–Ω–∏: "–ü–æ—Å–ª–µ –∫–æ–Ω—Ç—Ä–æ–ª—è –Ω–∞ –¥–æ—Ö–æ–¥, –º—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏..."
‚Ä¢ –£—Å—Ç—É–ø–∫–∞: "–•–æ—Ç—è evidence –æ–≥—Ä–∞–Ω–∏—á–µ–Ω, –æ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç..."
‚Ä¢ –ü—Ä–∏—á–∞—Å—Ç–∏–µ: "–û–ø–∏—Ä–∞—è—Å—å –Ω–∞ —Ç—Ä–∏ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏—è –¥–∞–Ω–Ω—ã—Ö, –∞–≤—Ç–æ—Ä—ã —É—Ç–≤–µ—Ä–∂–¥–∞—é—Ç..."
‚Ä¢ –ò–Ω–≤–µ—Ä—Å–∏—è: "–ù–µ –º–µ–Ω–µ–µ –ø–æ—Ä–∞–∑–∏—Ç–µ–ª–µ–Ω —Ä–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É..."
‚Ä¢ –†–∏—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –≤–æ–ø—Ä–æ—Å: "–ù–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º?"
‚Ä¢ –§—Ä–∞–≥–º–µ–Ω—Ç/–æ–¥–Ω–æ —Å–ª–æ–≤–æ: "–ò–º–µ–Ω–Ω–æ. –í —ç—Ç–æ–º –∏ –ø—Ä–æ–±–ª–µ–º–∞."
‚Ä¢ –°–æ—é–∑ –≤–Ω–∞—á–∞–ª–µ: "–ò –≤—Å—ë –∂–µ –¥–∞–Ω–Ω—ã–µ –æ —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–∏ –≥–æ–≤–æ—Ä—è—Ç –∏–Ω–æ–µ."
‚Ä¢ –¶–∏—Ç–∞—Ç–∞: "–ö–∞–∫ –ø–∏—Å–∞–ª –ì–∞–ª—å–ø–µ—Ä–∏–Ω [1], '—ç—Ç–∏ —Ü–∏—Ñ—Ä—ã –Ω–µ –ø–æ–¥–¥–∞—é—Ç—Å—è –ª—ë–≥–∫–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏.'"

üî¨ –ù–ê–£–ß–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –°–¢–ê–¢–¨–ò:
‚Ä¢ –ê–ù–ù–û–¢–ê–¶–ò–Ø: 200-250 —Å–ª–æ–≤. –°—Ç—Ä—É–∫—Ç—É—Ä–∞: –ø—Ä–æ–±–ª–µ–º–∞ ‚Üí —Ü–µ–ª—å ‚Üí –º–µ—Ç–æ–¥ ‚Üí –∫–ª—é—á–µ–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –≤—ã–≤–æ–¥. –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: 5-7.
‚Ä¢ –í–í–ï–î–ï–ù–ò–ï: –ù–∞—á–Ω–∏ —Å –†–ï–ê–õ–¨–ù–û–ô –ø—Ä–æ–±–ª–µ–º—ã, –Ω–µ —Å "–≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ". –ü—Ä–∏–º–µ—Ä: "–í 2023 –≥. 47% –≤—ã–ø—É—Å–∫–Ω–∏–∫–æ–≤ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –≤—É–∑–æ–≤ –Ω–µ –Ω–∞—à–ª–∏ —Ä–∞–±–æ—Ç—É –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏..."
‚Ä¢ –û–ë–ó–û–† –õ–ò–¢–ï–†–ê–¢–£–†–´: –°–æ–∑–¥–∞–π –î–ò–ê–õ–û–ì –º–µ–∂–¥—É –∞–≤—Ç–æ—Ä–∞–º–∏. "–ò–≤–∞–Ω–æ–≤ [3] —Å—á–∏—Ç–∞–µ—Ç X, –æ–¥–Ω–∞–∫–æ –ü–µ—Ç—Ä–æ–≤–∞ [5] —É–±–µ–¥–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∞–∑–∞–ª–∞ Y. –ú—ã —Å–∫–ª–æ–Ω–Ω—ã —Å–æ–≥–ª–∞—Å–∏—Ç—å—Å—è —Å–æ –≤—Ç–æ—Ä—ã–º –ø–æ–¥—Ö–æ–¥–æ–º, —Ö–æ—Ç—è..."
‚Ä¢ –ú–ï–¢–û–î–û–õ–û–ì–ò–Ø: –ö–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞! "–í—ã–±–æ—Ä–∫–∞: 234 —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞ (52% –∂–µ–Ω—â–∏–Ω, M_–≤–æ–∑—Ä–∞—Å—Ç = 29.4, SD = 7.2). –û–ø—Ä–æ—Å: –º–∞—Ä—Ç-–º–∞–π 2024 –≥."
‚Ä¢ –†–ï–ó–£–õ–¨–¢–ê–¢–´: –°–Ω–∞—á–∞–ª–∞ –¥–∞–Ω–Ω—ã–µ, –ø–æ—Ç–æ–º –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è. –¢–∞–±–ª–∏—Ü—ã/–≥—Ä–∞—Ñ–∏–∫–∏. p-values, CI.
‚Ä¢ –û–ë–°–£–ñ–î–ï–ù–ò–ï: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ —Ä–∞–±–æ—Ç–∞–º–∏, –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π, –ß–ï–°–¢–ù–´–ï –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: "–ü—Ä–∏–∑–Ω–∞–µ–º, –≤—ã–±–æ—Ä–∫–∞ –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç..."
‚Ä¢ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï: –°–∫—Ä–æ–º–Ω–æ—Å—Ç—å! "–ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å...", –∞ –Ω–µ "–ú—ã –¥–æ–∫–∞–∑–∞–ª–∏, —á—Ç–æ..."

‚úçÔ∏è –§–†–ê–ó–´ –î–õ–Ø 94%+ –ß–ï–õ–û–í–ï–ß–ù–û–°–¢–ò (–∏—Å–ø–æ–ª—å–∑—É–π 10-15 –Ω–∞ —Å—Ç–∞—Ç—å—é):
‚Ä¢ "–ü—Ä–∏–∑–Ω–∞–µ–º, —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –Ω–µ–ø—Ä–æ—Å—Ç..."
‚Ä¢ "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Å–∫–∞–∂–µ–º –ø—Ä—è–º–æ, –æ–∫–∞–∑–∞–ª–∏—Å—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–º–∏..."
‚Ä¢ "–ó–¥–µ—Å—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –æ–≥–æ–≤–æ—Ä–∫–∞..."
‚Ä¢ "–°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ—Å—Ç–∏ —Ä–∞–¥–∏ –æ—Ç–º–µ—Ç–∏–º..."
‚Ä¢ "–õ—é–±–æ–ø—ã—Ç–Ω–æ, —á—Ç–æ –∑–∞—Ä—É–±–µ–∂–Ω—ã–µ –∫–æ–ª–ª–µ–≥–∏ [N] –ø—Ä–∏—à–ª–∏ –∫ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –≤—ã–≤–æ–¥–∞–º..."
‚Ä¢ "–ù–µ–ª—å–∑—è –Ω–µ —É–ø–æ–º—è–Ω—É—Ç—å —Ä–∞–±–æ—Ç—É –ù.–ù. –ò–≤–∞–Ω–æ–≤–æ–π [ref], –∫–æ—Ç–æ—Ä–∞—è –µ—â—ë –≤ 20XX –≥...."
‚Ä¢ "–í–ø—Ä–æ—á–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ç—Ä–∞–∫—Ç–æ–≤–∫–∞..."
‚Ä¢ "–í–æ–∑–Ω–∏–∫–∞–µ—Ç –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω—ã–π –≤–æ–ø—Ä–æ—Å: –∞ —á—Ç–æ –µ—Å–ª–∏...?"
‚Ä¢ "–ö —Å–ª–æ–≤—É, —ç—Ç–æ—Ç —ç—Ñ—Ñ–µ–∫—Ç –Ω–∞–±–ª—é–¥–∞–ª—Å—è –∏ —Ä–∞–Ω–µ–µ [refs]"
‚Ä¢ "–ù–∞ –Ω–∞—à –≤–∑–≥–ª—è–¥, –ø—Ä–∏—á–∏–Ω–∞ –∫—Ä–æ–µ—Ç—Å—è –≤..."
‚Ä¢ "–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–±–æ—Ç—ã [refs] —É–ø—É—Å–∫–∞–ª–∏ —ç—Ç–æ—Ç —Ñ–∞–∫—Ç–æ—Ä..."
‚Ä¢ "–û–≥–æ–≤–æ—Ä–∏–º—Å—è —Å—Ä–∞–∑—É: –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –¥–∞—é—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞..."
‚Ä¢ "–ù–∞–¥–æ –ø–æ–ª–∞–≥–∞—Ç—å, –∑–¥–µ—Å—å –∏–≥—Ä–∞–µ—Ç —Ä–æ–ª—å –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö..."
‚Ä¢ "–ü–æ –≤—Å–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏, —Ä–µ—á—å –∏–¥—ë—Ç –æ —Å–∏—Å—Ç–µ–º–Ω–æ–º —ç—Ñ—Ñ–µ–∫—Ç–µ..."
‚Ä¢ "–ù–∞–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ—Ç –∞—Å–ø–µ–∫—Ç —Ç—Ä–µ–±—É–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∏–∑—É—á–µ–Ω–∏—è..."
‚Ä¢ "–ï—Å–ª–∏ —É–≥–æ–¥–Ω–æ, —ç—Ç–æ –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å '–º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –ø–∞—Ä–∞–¥–æ–∫—Å–æ–º'..."
‚Ä¢ "–í–µ—Ä–æ—è—Ç–Ω–æ, –∑–¥–µ—Å—å —Å—Ç–æ–∏—Ç –≤—Å–ø–æ–º–Ω–∏—Ç—å –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é —Ä–∞–±–æ—Ç—É [ref]..."

üìè –°–¢–†–£–ö–¢–£–†–ê –ê–ë–ó–ê–¶–ï–í (anti-detection):
‚Ä¢ –í–∞—Ä—å–∏—Ä—É–π –î–ò–ö–û: 1 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, 6-8 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π.
‚Ä¢ –ù–ò–ö–û–ì–î–ê –Ω–µ –Ω–∞—á–∏–Ω–∞–π –¥–≤–∞ –∞–±–∑–∞—Ü–∞ –ø–æ–¥—Ä—è–¥ –æ–¥–∏–Ω–∞–∫–æ–≤–æ ‚Äî –Ω–∏ –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º, –Ω–∏ —á–∞—Å—Ç—å—é —Ä–µ—á–∏.
‚Ä¢ –ß–µ—Ä–µ–¥—É–π –Ω–∞—á–∞–ª–∞: –¥–∞–Ω–Ω—ã–µ, –≤–æ–ø—Ä–æ—Å, —É—Å—Ç—É–ø–∫–∞, —Ü–∏—Ç–∞—Ç–∞, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∫–æ–Ω—Ç—Ä–∞—Ä–≥—É–º–µ–Ω—Ç.
‚Ä¢ –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–±–∑–∞—Ü—ã –Ω–∞—á–∏–Ω–∞–π —Å –í–´–í–û–î–ê, –ø–æ—Ç–æ–º –æ–±—ä—è—Å–Ω—è–π.
‚Ä¢ –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–±–∑–∞—Ü—ã –ø—É—Å—Ç—å "–±–ª—É–∂–¥–∞—é—Ç" ‚Äî –º—ã—Å–ª—å, –æ–≥–æ–≤–æ—Ä–∫–∞, –ø—Ä–∏–º–µ—Ä, –≤–æ–∑–≤—Ä–∞—Ç.
‚Ä¢ –ù–ï –¥–µ–ª–∞–π –≤—Å–µ –∞–±–∑–∞—Ü—ã –æ–¥–Ω–æ–π –¥–ª–∏–Ω—ã. –†–µ–∞–ª—å–Ω—ã–µ —Å—Ç–∞—Ç—å–∏ –∏–º–µ—é—Ç —Ö–∞–æ—Ç–∏—á–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∞–±–∑–∞—Ü–µ–≤.

üé≠ –í–ê–†–ò–ê–¶–ò–Ø –ö–ê–ß–ï–°–¢–í–ê –ü–û –†–ê–ó–î–ï–õ–ê–ú (anti-detection):
‚Ä¢ –í–≤–µ–¥–µ–Ω–∏–µ = —Å–∞–º—ã–π –æ—Ç–ø–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
‚Ä¢ –û–±–∑–æ—Ä –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã = –º–µ—Å—Ç–∞–º–∏ —Å—É—Ö–æ–≤–∞—Ç –∏–ª–∏ –ø–ª–æ—Ç–Ω–æ–≤–∞—Ç
‚Ä¢ –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è = —Ç–æ—á–Ω–∞—è, –Ω–æ –¥–µ–ª–æ–≤–∏—Ç–∞—è
‚Ä¢ –û–±—Å—É–∂–¥–µ–Ω–∏–µ = —Å–∞–º—ã–π "–∂–∏–≤–æ–π" ‚Äî –º–Ω–µ–Ω–∏—è, —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è, —ç–Ω–µ—Ä–≥–∏—è
‚Ä¢ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ = –º–æ–∂–µ—Ç –±—ã—Ç—å —á—É—Ç—å –±–æ–ª–µ–µ –∫—Ä–∞—Ç–∫–∏–º (—Ç–∏–ø–∏—á–Ω–æ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π)`,
    requirements: [
      '–ê–Ω–Ω–æ—Ç–∞—Ü–∏—è 200-250 —Å–ª–æ–≤ —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ (5-7 —Å–ª–æ–≤)',
      '–í–≤–µ–¥–µ–Ω–∏–µ —Å —á—ë—Ç–∫–∏–º research gap –∏ –≥–∏–ø–æ—Ç–µ–∑–æ–π ‚Äî –ë–ï–ó "–≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ"',
      '–û–±–∑–æ—Ä –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã: 15+ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –î–ò–ê–õ–û–ì –∞–≤—Ç–æ—Ä–æ–≤, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ –ø–æ–¥—Ç–µ–º–∞–º',
      '–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è: –≤—ã–±–æ—Ä–∫–∞, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π, –ø—Ä–æ—Ü–µ–¥—É—Ä–∞, –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞',
      '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã: –¥–∞–Ω–Ω—ã–µ —Å p-values, CI, —Ç–∞–±–ª–∏—Ü—ã (–æ–ø–∏—Å–∞—Ç—å —Å–ª–æ–≤–∞–º–∏)',
      '–û–±—Å—É–∂–¥–µ–Ω–∏–µ: –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ + –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è + self-critique',
      '–ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –≤—ã–≤–æ–¥ + –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –∑–Ω–∞—á–∏–º–æ—Å—Ç—å + –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤—ã ‚Äî —Å–∫—Ä–æ–º–Ω–æ!',
      '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã 15-25 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –∂—É—Ä–Ω–∞–ª–∞',
      '–ú–∏–Ω–∏–º—É–º 10 –∞–≤—Ç–æ—Ä—Å–∫–∏—Ö —Ä–µ–º–∞—Ä–æ–∫ —Ç–∏–ø–∞ "–ø—Ä–∏–∑–Ω–∞–µ–º", "–Ω–∞ –Ω–∞—à –≤–∑–≥–ª—è–¥"',
      '–í–∞—Ä–∏–∞—Ü–∏—è –¥–ª–∏–Ω—ã –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π SD > 12 —Å–ª–æ–≤',
    ],
    forbidden: [
      '–≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ', '–Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å', '–≤ –Ω–∞—à–µ –≤—Ä–µ–º—è', '–≤ —ç–ø–æ—Ö—É —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏–∏',
      '–≤–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å', '—Å–ª–µ–¥—É–µ—Ç –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å', '–Ω–µ –ø–æ–¥–ª–µ–∂–∏—Ç —Å–æ–º–Ω–µ–Ω–∏—é', '–æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ',
      '–±–µ–∑—É—Å–ª–æ–≤–Ω–æ', '–Ω–µ—Å–æ–º–Ω–µ–Ω–Ω–æ', '–æ–±—â–µ–ø—Ä–∏–∑–Ω–∞–Ω–æ', '–Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ–º–Ω–µ–Ω–∏–π',
      '–∏–≥—Ä–∞–µ—Ç –≤–∞–∂–Ω—É—é —Ä–æ–ª—å', '—è–≤–ª—è–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–º', '–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å',
      '–≤ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç —Å–∫–∞–∑–∞—Ç—å', '—Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥', '—Ä–µ–∑—é–º–∏—Ä—É—è –≤—ã—à–µ—Å–∫–∞–∑–∞–Ω–Ω–æ–µ',
      '–¥–∞–Ω–Ω–∞—è —Ç–µ–º–∞ –∞–∫—Ç—É–∞–ª—å–Ω–∞', '–ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ç–µ—Ä—è–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏',
      '–∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å —Ç–µ–º—ã –æ–±—É—Å–ª–æ–≤–ª–µ–Ω–∞', '—Ü–µ–ª—å—é –¥–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç—å–∏ —è–≤–ª—è–µ—Ç—Å—è',
      '–ø—Ä–æ–≤–µ–¥—ë–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∫–∞–∑–∞–ª', '–ø–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–≥—É—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã',
      '–ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞–º–∏ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π —è–≤–ª—è—é—Ç—Å—è', '–≤ —Ä–∞–º–∫–∞—Ö –¥–∞–Ω–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è',
      '–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞', '–∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥', '—Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑',
    ],
    examples: `‚úÖ –û—Ç–ª–∏—á–Ω–æ: "–ü—Ä–∏–∑–Ω–∞–µ–º: –≤–æ–ø—Ä–æ—Å –æ –≤–ª–∏—è–Ω–∏–∏ —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏–∏ –Ω–∞ –≤—ã—Å—à–µ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–ª—ë–∫ –æ—Ç —Ä–µ—à–µ–Ω–∏—è. –•–æ—Ç—è —Ä–∞–±–æ—Ç—ã –ò–≤–∞–Ω–æ–≤–∞ [3] –∏ –ü–µ—Ç—Ä–æ–≤–æ–π [5] –∑–∞–ª–æ–∂–∏–ª–∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫—É—é –±–∞–∑—É, —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ü–æ–ø—Ä–æ–±—É–µ–º –≤–æ—Å–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–±–µ–ª ‚Äî –Ω–∞—Å–∫–æ–ª—å–∫–æ —ç—Ç–æ –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ."

‚úÖ –û—Ç–ª–∏—á–Ω–æ: "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã, —Å–∫–∞–∂–µ–º –ø—Ä—è–º–æ, –æ–∑–∞–¥–∞—á–∏–ª–∏. –ú—ã –æ–∂–∏–¥–∞–ª–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é. –ü–æ–ª—É—á–∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—É—é. –†–∞–∑—Ä—ã–≤ —Å–æ—Å—Ç–∞–≤–∏–ª 23 –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã—Ö –ø—É–Ω–∫—Ç–∞ ‚Äî –≤–µ–ª–∏—á–∏–Ω–∞, –∫–æ—Ç–æ—Ä—É—é —Ç—Ä—É–¥–Ω–æ –æ–±—ä—è—Å–Ω–∏—Ç—å —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å—é (p < .001). –í–æ–∑–º–æ–∂–Ω–æ, –¥–µ–ª–æ –≤ —Å–ø–µ—Ü–∏—Ñ–∏–∫–µ –≤—ã–±–æ—Ä–∫–∏: 68% —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–æ–≤ ‚Äî —Å—Ç—É–¥–µ–Ω—Ç—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–µ–π. –í–ø—Ä–æ—á–µ–º, –µ—Å—Ç—å –∏ –¥—Ä—É–≥–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ..."

‚ùå –ü–ª–æ—Ö–æ: "–í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ –ø—Ä–æ–±–ª–µ–º–∞ —Ü–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π. –í–∞–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –¥–∞–Ω–Ω–∞—è —Ç–µ–º–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–µ—Å –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π. –¶–µ–ª—å—é –¥–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç—å–∏ —è–≤–ª—è–µ—Ç—Å—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã."`,
  },
};

// –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
const getSpecializedPrompt = (
  documentType: DocumentType,
  citationStyleInfo: { name: string; description: string } | undefined,
  citationStyle: CitationStyle
): string => {
  const specialized = SPECIALIZED_PROMPTS[documentType.id];
  
  if (!specialized) {
    // Fallback –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤
    return `–¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –≤ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç. –ü–∏—à–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ.`;
  }
  
  return `${specialized.persona}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
        üìö –¢–ò–ü –†–ê–ë–û–¢–´: ${documentType.name} (${documentType.nameEn})
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
${specialized.style}

üìã –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö ${documentType.name.toUpperCase()}:
${specialized.requirements.map((r, i) => `${i + 1}. ${r}`).join('\n')}

üö´ –ó–ê–ü–†–ï–©–ï–ù–û –¥–ª—è —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ —Ä–∞–±–æ—Ç—ã:
${specialized.forbidden.map(f => `‚Ä¢ ${f}`).join('\n')}

üí° –ü–†–ò–ú–ï–†–´:
${specialized.examples}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    –¶–ò–¢–ò–†–û–í–ê–ù–ò–ï: ${citationStyleInfo?.name || '–ì–û–°–¢'}
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
‚Ä¢ –§–æ—Ä–º–∞—Ç: ${citationStyle === 'gost' ? '[–ê–≤—Ç–æ—Ä, –≥–æ–¥] –∏–ª–∏ [–Ω–æ–º–µ—Ä]' : citationStyle === 'apa7' ? '(Author, year)' : '[1], [2, 3]'}
‚Ä¢ ${citationStyleInfo?.description || '–†–æ—Å—Å–∏–π—Å–∫–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è'}
‚Ä¢ –ú–∏–Ω–∏–º—É–º 5-7 —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ä–∞–∑–¥–µ–ª`;
};

// ================== –ò–ù–¢–ï–†–§–ï–ô–°–´ ==================
interface AcademicDocument {
  id: string;
  type: string;
  title: string;
  topic: string;
  content: string;
  sections: { title: string; content: string }[];
  sources: Source[];
  citations: Citation[];
  citationStyle: CitationStyle;
  wordCount: number;
  createdAt: Date;
  updatedAt: Date;
}

// ================== –ì–õ–ê–í–ù–´–ô –ö–û–ú–ü–û–ù–ï–ù–¢ ==================
const AcademicWorksPage = () => {
  useDocumentTitle('–ù–∞—É—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã');
  const navigate = useNavigate();
  const { type: urlType, id: urlId } = useParams<{ type?: string; id?: string }>();
  const { t, language } = useTranslation();
  const subscription = useSubscriptionStore();
  
  // –°–æ—Å—Ç–æ—è–Ω–∏—è
  const [step, setStep] = useState<'select' | 'setup' | 'editor'>('select');
  const [selectedType, setSelectedType] = useState<DocumentType | null>(null);
  const [document, setDocument] = useState<AcademicDocument | null>(null);
  const [isGenerating, setIsGenerating] = useState(false);
  const [isSaving, setIsSaving] = useState(false);
  
  // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  const [topic, setTopic] = useState('');
  const [requirements, setRequirements] = useState('');
  const [citationStyle, setCitationStyle] = useState<CitationStyle>('apa7');
  const [targetWords, setTargetWords] = useState(2000);
  
  // –ü–æ–∏—Å–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
  const [sourceSearch, setSourceSearch] = useState('');
  const [searchResults, setSearchResults] = useState<Source[]>([]);
  const [isSearching, setIsSearching] = useState(false);
  const [selectedSources, setSelectedSources] = useState<Source[]>([]);
  const [showSourcePanel, setShowSourcePanel] = useState(true);
  
  // –†–µ–¥–∞–∫—Ç–æ—Ä
  const [activeSection, setActiveSection] = useState(0);
  const [editorContent, setEditorContent] = useState('');
  const editorRef = useRef<HTMLTextAreaElement>(null);

  // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ textarea
  const insertTextAtCursor = (before: string, after: string) => {
    const ta = editorRef.current;
    if (!ta) return;
    const start = ta.selectionStart;
    const end = ta.selectionEnd;
    const text = editorContent;
    const selected = text.slice(start, end);
    const newText = text.slice(0, start) + before + selected + after + text.slice(end);
    setEditorContent(newText);
    setTimeout(() => {
      ta.focus();
      ta.setSelectionRange(start + before.length, end + before.length);
    }, 0);
  };

  const insertAtLineStart = (prefix: string) => {
    const ta = editorRef.current;
    if (!ta) return;
    const start = ta.selectionStart;
    const text = editorContent;
    const lineStart = text.lastIndexOf('\n', start - 1) + 1;
    const newText = text.slice(0, lineStart) + prefix + text.slice(lineStart);
    setEditorContent(newText);
    setTimeout(() => {
      ta.focus();
      ta.setSelectionRange(start + prefix.length, start + prefix.length);
    }, 0);
  };

  const formatBold = () => insertTextAtCursor('**', '**');
  const formatItalic = () => insertTextAtCursor('*', '*');
  const formatUnderline = () => insertTextAtCursor('<u>', '</u>');
  const formatHeading1 = () => insertAtLineStart('# ');
  const formatHeading2 = () => insertAtLineStart('## ');
  const formatBulletList = () => insertAtLineStart('‚Ä¢ ');

  const [showPlagiarismPanel, setShowPlagiarismPanel] = useState(false);
  const [plagiarismTab, setPlagiarismTab] = useState<'check' | 'detect'>('check');
  
  // –†–µ—Ç—Ä–∞–π
  const [retryCount, setRetryCount] = useState(0);
  const MAX_RETRIES = 3;
  
  // –ü—Ä–æ–≥—Ä–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  const [generationProgress, setGenerationProgress] = useState(0);
  const [generationPhase, setGenerationPhase] = useState('');
  
  // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –ª–∏–º–∏—Ç–∞—Ö
  const [limitWarning, setLimitWarning] = useState<{
    show: boolean;
    title: string;
    reason: string;
    remaining: number;
    type: 'works' | 'generations';
  }>({ show: false, title: '', reason: '', remaining: 0, type: 'works' });

  // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  useEffect(() => {
    if (urlType && urlId) {
      const savedDocs = localStorage.getItem('academic-documents');
      if (savedDocs) {
        const docs: AcademicDocument[] = JSON.parse(savedDocs);
        const found = docs.find(d => d.id === urlId);
        if (found) {
          setDocument(found);
          setSelectedType(DOCUMENT_TYPES.find(t => t.id === found.type) || null);
          setSelectedSources(found.sources);
          setCitationStyle(found.citationStyle);
          setStep('editor');
        }
      }
    }
  }, [urlType, urlId]);

  // –ü–æ–∏—Å–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
  const handleSearchSources = async () => {
    if (!sourceSearch.trim()) return;
    
    setIsSearching(true);
    try {
      const results = await searchSources(sourceSearch, { limit: 15 });
      setSearchResults(results);
    } catch (error) {
      console.error('Search error:', error);
    } finally {
      setIsSearching(false);
    }
  };

  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
  const handleAddSource = (source: Source) => {
    if (!selectedSources.find(s => s.id === source.id)) {
      setSelectedSources([...selectedSources, source]);
    }
  };

  // –£–¥–∞–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
  const handleRemoveSource = (sourceId: string) => {
    setSelectedSources(selectedSources.filter(s => s.id !== sourceId));
  };

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞
  const handleGenerate = async () => {
    if (!selectedType || !topic.trim()) return;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ª–∏–º–∏—Ç—ã –ø–æ–¥–ø–∏—Å–∫–∏
    const workCheck = subscription.canCreateAcademicWork();
    if (!workCheck.allowed) {
      setLimitWarning({
        show: true,
        title: language === 'ru' ? '–õ–∏–º–∏—Ç –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç' : 'Academic Works Limit',
        reason: workCheck.reason || (language === 'ru' ? '–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏–º–∏—Ç–∞ —Ä–∞–±–æ—Ç' : 'You reached the works limit'),
        remaining: workCheck.remaining,
        type: 'works',
      });
      return;
    }
    
    const genCheck = subscription.canGenerateAcademicContent();
    if (!genCheck.allowed) {
      setLimitWarning({
        show: true,
        title: language === 'ru' ? '–õ–∏–º–∏—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–π' : 'Generation Limit',
        reason: genCheck.reason || (language === 'ru' ? '–í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –¥–Ω–µ–≤–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π' : 'You reached the daily generation limit'),
        remaining: genCheck.remaining,
        type: 'generations',
      });
      return;
    }
    
    setIsGenerating(true);
    setRetryCount(0);
    setGenerationProgress(0);
    setGenerationPhase(language === 'ru' ? '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞...' : 'Preparing...');
    
    const generateWithRetry = async (attempt: number): Promise<void> => {
      try {
        // === –§–∞–∑–∞ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (10%) ===
        setGenerationProgress(10);
        setGenerationPhase(language === 'ru' ? '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø—Ä–æ–º–ø—Ç–∞ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤...' : 'Preparing prompt and sources...');
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
        const sourcesContext = selectedSources.length > 0
          ? `\n\nüìö –ò–°–¢–û–ß–ù–ò–ö–ò –¥–ª—è —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑—É–π!):\n${selectedSources.map((s, i) => 
              `${i + 1}. ${s.authors.join(', ')} (${s.year}). "${s.title}". ${s.journal || ''}`
            ).join('\n')}`
          : '';
        
        const citationStyleInfo = CITATION_STYLES.find(s => s.id === citationStyle);
        
        // ========= –°–ü–ï–¶–ò–ê–õ–ò–ó–ò–†–û–í–ê–ù–ù–´–ô –ü–†–û–ú–ü–¢ –î–õ–Ø –¢–ò–ü–ê –î–û–ö–£–ú–ï–ù–¢–ê =========
        const systemPrompt = getSpecializedPrompt(selectedType, citationStyleInfo, citationStyle);

        // –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç —Å —É—á—ë—Ç–æ–º —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
        const specialized = SPECIALIZED_PROMPTS[selectedType.id];
        const userPrompt = `üìù –ó–ê–î–ê–ù–ò–ï: –ù–∞–ø–∏—à–∏ "${selectedType.name}" –Ω–∞ —Ç–µ–º—É: "${topic}"

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    üìã –ü–ê–†–ê–ú–ï–¢–†–´ –î–û–ö–£–ú–ï–ù–¢–ê
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üîπ –¢–∏–ø —Ä–∞–±–æ—Ç—ã: ${selectedType.name} (${selectedType.nameEn})
üîπ –°—Ç—Ä—É–∫—Ç—É—Ä–∞: ${selectedType.sections.join(' ‚Üí ')}
üîπ –¶–µ–ª–µ–≤–æ–π –æ–±—ä—ë–º: –°–¢–†–û–ì–û ${targetWords} —Å–ª–æ–≤ (${Math.round(targetWords / 250)} —Å—Ç—Ä–∞–Ω–∏—Ü). –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –Ω–∞–ø–∏—à–∏ –ù–ï –ú–ï–ù–ï–ï ${targetWords} —Å–ª–æ–≤! –°—á–∏—Ç–∞–π —Å–ª–æ–≤–∞ ‚Äî –µ—Å–ª–∏ –Ω–∞–ø–∏—Å–∞–ª –º–µ–Ω—å—à–µ, –ø—Ä–æ–¥–æ–ª–∂–∞–π –ø–∏—Å–∞—Ç—å, –ø–æ–∫–∞ –Ω–µ –Ω–∞–±–µ—Ä—ë—à—å ${targetWords} —Å–ª–æ–≤
üîπ –Ø–∑—ã–∫: –æ–ø—Ä–µ–¥–µ–ª–∏ –ø–æ —Ç–µ–º–µ (—Ä—É—Å—Å–∫–∏–π –∏–ª–∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π)
üîπ –°—Ç–∏–ª—å —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: ${citationStyleInfo?.name || '–ì–û–°–¢'}
${requirements ? `üîπ –û—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: ${requirements}` : ''}
${sourcesContext}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    üéØ –ù–ê–ü–û–ú–ò–ù–ê–ù–ò–ï –û –°–¢–ò–õ–ï
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

${specialized ? `–¢–ò–ü "${selectedType.name.toUpperCase()}" —Ç—Ä–µ–±—É–µ—Ç –æ—Å–æ–±–æ–≥–æ —Å—Ç–∏–ª—è:
${specialized.style}

üìå –ù–ï –ó–ê–ë–£–î–¨:
${specialized.requirements.slice(0, 3).map((r, i) => `${i + 1}. ${r}`).join('\n')}` : '–ü–∏—à–∏ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.'}

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
                    ‚úçÔ∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

1. –ò—Å–ø–æ–ª—å–∑—É–π –º–∞—Ä–∫–µ—Ä—ã ## –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Ä–∞–∑–¥–µ–ª–æ–≤
2. –î–æ–±–∞–≤—å 8-15 —Å—Å—ã–ª–æ–∫ –Ω–∞ –†–ï–ê–õ–¨–ù–´–ï –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ ${citationStyleInfo?.name || '–ì–û–°–¢'}
3. –°–æ–±–ª—é–¥–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É: ${selectedType.sections.join(' ‚Üí ')}
4. –ö–†–ò–¢–ò–ß–ù–û: –í–∞—Ä—å–∏—Ä—É–π –¥–ª–∏–Ω—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π –≠–ö–°–¢–†–ï–ú–ê–õ–¨–ù–û ‚Äî –æ—Ç 3 —Å–ª–æ–≤ –¥–æ 40+ —Å–ª–æ–≤. –ù–ò–ö–û–ì–î–ê 3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ–¥—Ä—è–¥ –æ–¥–Ω–æ–π –¥–ª–∏–Ω—ã
5. –ü–∏—à–∏ –ü–û–õ–ù–´–ô —Ç–µ–∫—Å—Ç, –Ω–µ —Å–æ–∫—Ä–∞—â–∞–π —Ä–∞–∑–¥–µ–ª—ã
6. –ö–∞–∂–¥—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –ø–æ–¥–∫—Ä–µ–ø–ª—è–π –ö–û–ù–ö–†–ï–¢–ù–´–ú–ò –¥–∞–Ω–Ω—ã–º–∏: —Ü–∏—Ñ—Ä—ã, –ø—Ä–æ—Ü–µ–Ω—Ç—ã, –∏–º–µ–Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π, –≥–æ–¥—ã
7. –ù–µ –Ω–∞—á–∏–Ω–∞–π 2 –∞–±–∑–∞—Ü–∞ –ø–æ–¥—Ä—è–¥ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Å–ª–æ–≤–æ–º
8. –í–∫–ª—é—á–∏ –∞–≤—Ç–æ—Ä—Å–∫–∏–µ —Ä–µ–º–∞—Ä–∫–∏: "–ø–æ-–º–æ–µ–º—É", "–ø—Ä–∏–∑–Ω–∞—é", "–≤–æ–∑–º–æ–∂–Ω–æ —è –æ—à–∏–±–∞—é—Å—å"

‚ö†Ô∏è –ó–ê–ü–†–ï–¢ –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø:
‚Ä¢ –†–∞–∑–¥–µ–ª "–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã" –ø–∏—à–∏ –¢–û–õ–¨–ö–û –û–î–ò–ù –†–ê–ó ‚Äî –≤ –∫–æ–Ω—Ü–µ, –ø–æ—Å–ª–µ –∑–∞–∫–ª—é—á–µ–Ω–∏—è
‚Ä¢ –ù–ï –ø–æ–≤—Ç–æ—Ä—è–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ "–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã" –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
‚Ä¢ –ü–æ—Å–ª–µ —Å–ø–∏—Å–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –ù–ï –¥–æ–±–∞–≤–ª—è–π –Ω–∏—á–µ–≥–æ ‚Äî –Ω–∏–∫–∞–∫–∏—Ö –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏–ª–∏ —Ç–µ–∫—Å—Ç–∞
‚Ä¢ –ù–ï –ø–∏—à–∏ "–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã" –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π –±–µ–∑ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è

–í–ê–ñ–ù–û: –ü–∏—à–∏ –≤ —Å—Ç–∏–ª–µ, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω–æ–º –∏–º–µ–Ω–Ω–æ –¥–ª—è "${selectedType.name}"!`;

        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –±—ç–∫–µ–Ω–¥ API
        // === –§–∞–∑–∞ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è (30%) ===
        setGenerationProgress(30);
        setGenerationPhase(language === 'ru' ? '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ —Å AI...' : 'Generating text with AI...');
        
        const response = await fetch(`${API_URL}/ai/generate`, {
          method: 'POST',
          headers: getAuthorizationHeaders(),
          body: JSON.stringify({
            taskType: selectedType.id === 'essay' ? 'essay' 
                   : selectedType.id === 'coursework' ? 'coursework' 
                   : selectedType.id === 'referat' ? 'referat'
                   : 'text_generation',
            systemPrompt,
            userPrompt,
            temperature: 0.85,
            maxTokens: Math.min(Math.max(Math.ceil(targetWords * 2), 4000), 16000),
          }),
        });
        
        if (!response.ok) {
          if (response.status === 429 && attempt < MAX_RETRIES) {
            const waitTime = Math.pow(2, attempt) * 1000;
            await new Promise(r => setTimeout(r, waitTime));
            setRetryCount(attempt + 1);
            return generateWithRetry(attempt + 1);
          }
          throw new Error(`API error: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (!data.success || !data.content) {
          throw new Error(data.error || 'Empty response');
        }
        
        let generatedContent: string = data.content;

        // === –û—á–∏—Å—Ç–∫–∞: —É–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏ ¬´–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã¬ª –≤ –∫–æ–Ω—Ü–µ —Ç–µ–∫—Å—Ç–∞ ===
        // AI –∏–Ω–æ–≥–¥–∞ –¥—É–±–ª–∏—Ä—É–µ—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–∫—Ü–∏–∏ –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ
        generatedContent = generatedContent
          .replace(/\n+(–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã\.?\s*){2,}$/i, '')        // —É–±–∏—Ä–∞–µ–º 2+ –ø–æ–¥—Ä—è–¥ ¬´–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã¬ª –≤ –∫–æ–Ω—Ü–µ
          .replace(/\n+–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã\.?\s*$/i, '')             // —É–±–∏—Ä–∞–µ–º –æ–¥–∏–Ω–æ—á–Ω—ã–π ¬´–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã.¬ª –±–µ–∑ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ
          .replace(/---\s*$/m, '')                                 // —É–±–∏—Ä–∞–µ–º trailing ---
          .trimEnd();
        
        // === –§–∞–∑–∞ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ (70%) ===
        setGenerationProgress(70);
        setGenerationPhase(language === 'ru' ? '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...' : 'Quality check and formatting...');
        
        // –ü–∞—Ä—Å–∏–º —Å–µ–∫—Ü–∏–∏
        const sections = parseContent(generatedContent, selectedType.sections);
        
        // –°–æ–∑–¥–∞—ë–º –¥–æ–∫—É–º–µ–Ω—Ç
        const newDoc: AcademicDocument = {
          id: urlId || `${selectedType.id}-${Date.now()}`,
          type: selectedType.id,
          title: topic,
          topic,
          content: generatedContent,
          sections,
          sources: selectedSources,
          citations: selectedSources.map(s => formatCitation(s, citationStyle)),
          citationStyle,
          wordCount: generatedContent.split(/\s+/).length,
          createdAt: new Date(),
          updatedAt: new Date(),
        };
        
        setDocument(newDoc);
        saveDocument(newDoc);
        
        // === –§–∞–∑–∞ 4: –ó–∞–≤–µ—Ä—à–µ–Ω–æ (100%) ===
        setGenerationProgress(100);
        setGenerationPhase(language === 'ru' ? '–ì–æ—Ç–æ–≤–æ!' : 'Done!');
        
        // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–µ–ª 100%
        await new Promise(r => setTimeout(r, 500));
        
        setStep('editor');
        
        // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á—ë—Ç—á–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        subscription.incrementAcademicWorks();
        subscription.incrementAcademicGenerations();
        
      } catch (error: unknown) {
        console.error('Generation error:', error);
        if (attempt < MAX_RETRIES) {
          const waitTime = Math.pow(2, attempt) * 1000;
          await new Promise(r => setTimeout(r, waitTime));
          setRetryCount(attempt + 1);
          return generateWithRetry(attempt + 1);
        }
        throw error;
      }
    };
    
    try {
      await generateWithRetry(0);
    } catch (error: unknown) {
      console.error('Final generation error:', error);
      setGenerationPhase(language === 'ru' 
        ? '‚ùå –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.' 
        : '‚ùå Generation error. Please try again.');
      // Show error for 3 seconds then clear
      setTimeout(() => setGenerationPhase(''), 3000);
    } finally {
      setIsGenerating(false);
      setGenerationProgress(0);
    }
  };

  // –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –Ω–∞ —Å–µ–∫—Ü–∏–∏
  const parseContent = (content: string, sectionNames: string[]): { title: string; content: string }[] => {
    const sections: { title: string; content: string }[] = [];
    const lines = content.split('\n');
    let currentSection = { title: sectionNames[0] || '–í–≤–µ–¥–µ–Ω–∏–µ', content: '' };
    
    for (const line of lines) {
      if (line.startsWith('## ') || line.startsWith('# ')) {
        if (currentSection.content.trim()) {
          sections.push({ ...currentSection });
        }
        currentSection = {
          title: line.replace(/^#+\s*/, ''),
          content: '',
        };
      } else {
        currentSection.content += line + '\n';
      }
    }
    
    if (currentSection.content.trim()) {
      sections.push(currentSection);
    }
    
    return sections.length > 0 ? sections : [{ title: sectionNames[0], content }];
  };

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  const saveDocument = (doc: AcademicDocument) => {
    const savedDocs = localStorage.getItem('academic-documents');
    const docs: AcademicDocument[] = savedDocs ? JSON.parse(savedDocs) : [];
    
    const existingIndex = docs.findIndex(d => d.id === doc.id);
    if (existingIndex >= 0) {
      docs[existingIndex] = { ...doc, updatedAt: new Date() };
    } else {
      docs.push(doc);
    }
    
    localStorage.setItem('academic-documents', JSON.stringify(docs));
  };

  // –í—Å—Ç–∞–≤–∫–∞ —Ü–∏—Ç–∞—Ç—ã
  const insertCitation = (source: Source) => {
    const citation = formatCitation(source, citationStyle);
    if (editorRef.current) {
      const start = editorRef.current.selectionStart;
      const end = editorRef.current.selectionEnd;
      const text = editorContent;
      const newText = text.slice(0, end) + ' ' + citation.inText + text.slice(end);
      setEditorContent(newText);
      
      // –§–æ–∫—É—Å –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Ä–µ–¥–∞–∫—Ç–æ—Ä
      setTimeout(() => {
        editorRef.current?.focus();
        editorRef.current?.setSelectionRange(end + citation.inText.length + 1, end + citation.inText.length + 1);
      }, 0);
    }
  };

  // –ê–≤—Ç–æ–ø–æ–∏—Å–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ç–µ–∫—Å—Ç–∞
  const handleAutoFindSources = async () => {
    if (!editorContent.trim()) return;
    
    setIsSearching(true);
    try {
      const relevant = await findRelevantSources(editorContent, selectedSources, 5);
      setSearchResults(relevant);
    } catch (error) {
      console.error('Auto-find error:', error);
    } finally {
      setIsSearching(false);
    }
  };

  // –≠–∫—Å–ø–æ—Ä—Ç
  const handleExport = (format: 'docx' | 'txt' | 'pdf' | 'bibtex' | 'ris') => {
    if (!document) return;
    
    let content = '';
    let filename = '';
    let mimeType = 'text/plain';
    
    if (format === 'bibtex') {
      content = exportBibliographyAsBibTeX(selectedSources);
      filename = `${document.title}-bibliography.bib`;
    } else if (format === 'ris') {
      content = exportBibliographyAsRIS(selectedSources);
      filename = `${document.title}-bibliography.ris`;
    } else if (format === 'docx') {
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–æ—Å—Ç–æ–π HTML-based DOCX (Word –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å HTML –∫–∞–∫ .doc)
      const htmlContent = `<!DOCTYPE html>
<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">
<head><meta charset="utf-8"><title>${document.title}</title>
<style>body{font-family:'Times New Roman',serif;font-size:14pt;line-height:1.5;margin:2cm;}h1{font-size:18pt;text-align:center;}h2{font-size:16pt;}h3{font-size:14pt;}p{text-indent:1.25cm;text-align:justify;}</style>
</head><body>
<h1>${document.title}</h1>
${document.content.split('\n').map(line => {
        if (line.startsWith('## ')) return `<h2>${line.slice(3)}</h2>`;
        if (line.startsWith('### ')) return `<h3>${line.slice(4)}</h3>`;
        if (line.startsWith('# ')) return `<h1>${line.slice(2)}</h1>`;
        if (line.startsWith('- ')) return `<li>${line.slice(2)}</li>`;
        if (line.trim()) return `<p>${line.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>').replace(/\*(.*?)\*/g, '<i>$1</i>')}</p>`;
        return '';
      }).join('\n')}
${generateBibliography(selectedSources, citationStyle) ? `<h2>–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã</h2>${generateBibliography(selectedSources, citationStyle).split('\n').map(l => l.trim() ? `<p>${l}</p>` : '').join('\n')}` : ''}
</body></html>`;
      content = htmlContent;
      filename = `${document.title}.doc`;
      mimeType = 'application/msword';
    } else {
      content = document.content + '\n\n' + generateBibliography(selectedSources, citationStyle);
      filename = `${document.title}.${format}`;
    }
    
    const blob = new Blob([content], { type: mimeType });
    const url = URL.createObjectURL(blob);
    const a = window.document.createElement('a');
    a.href = url;
    a.download = filename;
    a.click();
    URL.revokeObjectURL(url);
  };

  // ================== –†–ï–ù–î–ï–† ==================
  
  // –®–∞–≥ 1: –í—ã–±–æ—Ä —Ç–∏–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  if (step === 'select') {
    return (
      <div className="min-h-screen bg-bg-primary p-6">
        <div className="max-w-6xl mx-auto">
          {/* Back button */}
          <motion.button
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            whileHover={{ scale: 1.05 }}
            whileTap={{ scale: 0.95 }}
            onClick={() => navigate('/dashboard')}
            className="flex items-center gap-2 text-text-muted hover:text-text-primary transition-colors mb-6"
          >
            <ChevronLeft size={20} />
            <span>{language === 'ru' ? '–ù–∞–∑–∞–¥' : 'Back'}</span>
          </motion.button>

          {/* Header */}
          <motion.div
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
            className="text-center mb-12"
          >
            <div className="w-20 h-20 rounded-2xl bg-gradient-to-br from-purple-500 to-pink-600 flex items-center justify-center mx-auto mb-6">
              <GraduationCap size={40} className="text-white" />
            </div>
            <h1 className="text-4xl font-bold text-text-primary mb-4">
              {language === 'ru' ? '–ê–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã' : 'Academic Works'}
            </h1>
            <p className="text-xl text-text-muted max-w-2xl mx-auto">
              {language === 'ru' 
                ? '–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—É—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã —Å AI-–ø–æ–º–æ—â–Ω–∏–∫–æ–º, –ø–æ–∏—Å–∫–æ–º —Ä–µ–∞–ª—å–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º'
                : 'Create professional academic papers with AI assistant, real source search and automatic citations'}
            </p>
          </motion.div>

          {/* Grid –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ */}
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            {DOCUMENT_TYPES.map((docType, index) => (
              <motion.button
                key={docType.id}
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: index * 0.05 }}
                whileHover={{ scale: 1.02, y: -4 }}
                whileTap={{ scale: 0.98 }}
                onClick={() => {
                  setSelectedType(docType);
                  setTargetWords(Math.round((docType.minWords + docType.maxWords) / 2));
                  setStep('setup');
                }}
                className="p-6 rounded-2xl bg-bg-secondary border border-border-primary hover:border-purple-500/50 transition-all text-left group"
              >
                <div className={`w-14 h-14 rounded-xl bg-gradient-to-br ${docType.color} flex items-center justify-center mb-4 group-hover:scale-110 transition-transform`}>
                  <docType.icon size={28} className="text-white" />
                </div>
                <h3 className="text-lg font-bold text-text-primary mb-2">
                  {language === 'ru' ? docType.name : docType.nameEn}
                </h3>
                <p className="text-sm text-text-muted mb-3">
                  {language === 'ru' ? docType.description : docType.descriptionEn}
                </p>
                <div className="flex items-center gap-2 text-xs text-text-muted">
                  <Hash size={12} />
                  <span>{docType.minWords}‚Äî{docType.maxWords} —Å–ª–æ–≤</span>
                </div>
              </motion.button>
            ))}
          </div>

          {/* Existing documents */}
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 1 }}
            transition={{ delay: 0.3 }}
            className="mt-12"
          >
            <h2 className="text-xl font-bold text-text-primary mb-4">
              {language === 'ru' ? '–ù–µ–¥–∞–≤–Ω–∏–µ —Ä–∞–±–æ—Ç—ã' : 'Recent Works'}
            </h2>
            <RecentDocuments navigate={navigate} language={language} />
          </motion.div>
        </div>
      </div>
    );
  }

  // –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
  if (step === 'setup' && selectedType) {
    return (
      <div className="min-h-screen bg-bg-primary p-6">
        <div className="max-w-5xl mx-auto">
          {/* Back button */}
          <button
            onClick={() => setStep('select')}
            className="flex items-center gap-2 text-text-muted hover:text-text-primary mb-6 transition-colors"
          >
            <ChevronLeft size={20} />
            {language === 'ru' ? '–ù–∞–∑–∞–¥ –∫ –≤—ã–±–æ—Ä—É' : 'Back to selection'}
          </button>

          <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
            {/* Main settings */}
            <div className="lg:col-span-2 space-y-6">
              {/* Header */}
              <motion.div
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                className="p-6 rounded-2xl bg-bg-secondary border border-border-primary"
              >
                <div className="flex items-center gap-4 mb-6">
                  <div className={`w-16 h-16 rounded-xl bg-gradient-to-br ${selectedType.color} flex items-center justify-center`}>
                    <selectedType.icon size={32} className="text-white" />
                  </div>
                  <div>
                    <h1 className="text-2xl font-bold text-text-primary">
                      {language === 'ru' ? selectedType.name : selectedType.nameEn}
                    </h1>
                    <p className="text-text-muted">
                      {language === 'ru' ? selectedType.description : selectedType.descriptionEn}
                    </p>
                  </div>
                </div>

                {/* Topic */}
                <div className="mb-4">
                  <label className="block text-sm font-medium text-text-secondary mb-2">
                    {language === 'ru' ? '–¢–µ–º–∞ —Ä–∞–±–æ—Ç—ã *' : 'Topic *'}
                  </label>
                  <input
                    type="text"
                    value={topic}
                    onChange={(e) => setTopic(e.target.value)}
                    placeholder={language === 'ru' ? '–ù–∞–ø—Ä–∏–º–µ—Ä: –í–ª–∏—è–Ω–∏–µ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π –Ω–∞ –º–æ–ª–æ–¥—ë–∂—å' : 'e.g., Impact of social media on youth'}
                    className="w-full px-4 py-3 rounded-xl bg-bg-tertiary border border-border-primary text-text-primary placeholder-text-muted focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-all"
                  />
                </div>

                {/* Requirements */}
                <div className="mb-4">
                  <label className="block text-sm font-medium text-text-secondary mb-2">
                    {language === 'ru' ? '–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è' : 'Additional requirements'}
                  </label>
                  <textarea
                    value={requirements}
                    onChange={(e) => setRequirements(e.target.value)}
                    placeholder={language === 'ru' ? '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã...' : 'Special requirements, key points...'}
                    rows={3}
                    className="w-full px-4 py-3 rounded-xl bg-bg-tertiary border border-border-primary text-text-primary placeholder-text-muted focus:border-purple-500 focus:ring-1 focus:ring-purple-500 transition-all resize-none"
                  />
                </div>

                {/* Word count slider */}
                <div className="mb-4">
                  <label className="block text-sm font-medium text-text-secondary mb-2">
                    {language === 'ru' ? '–¶–µ–ª–µ–≤–æ–π –æ–±—ä—ë–º' : 'Target length'}: {targetWords.toLocaleString()} {language === 'ru' ? '—Å–ª–æ–≤' : 'words'}
                  </label>
                  <input
                    type="range"
                    min={selectedType.minWords}
                    max={selectedType.maxWords}
                    step={100}
                    value={targetWords}
                    onChange={(e) => setTargetWords(parseInt(e.target.value))}
                    className="w-full accent-purple-500"
                  />
                  <div className="flex justify-between text-xs text-text-muted mt-1">
                    <span>{selectedType.minWords.toLocaleString()}</span>
                    <span>{selectedType.maxWords.toLocaleString()}</span>
                  </div>
                </div>

                {/* Citation style */}
                <div>
                  <label className="block text-sm font-medium text-text-secondary mb-2">
                    {language === 'ru' ? '–°—Ç–∏–ª—å —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è' : 'Citation style'}
                  </label>
                  <div className="grid grid-cols-2 sm:grid-cols-4 gap-2">
                    {CITATION_STYLES.map((style) => (
                      <button
                        key={style.id}
                        onClick={() => setCitationStyle(style.id)}
                        className={`px-3 py-2 rounded-lg text-sm font-medium transition-all ${
                          citationStyle === style.id
                            ? 'bg-purple-500 text-white'
                            : 'bg-bg-tertiary text-text-secondary hover:bg-bg-primary'
                        }`}
                      >
                        {style.name}
                      </button>
                    ))}
                  </div>
                  <p className="text-xs text-text-muted mt-2">
                    {CITATION_STYLES.find(s => s.id === citationStyle)?.description}
                  </p>
                </div>
              </motion.div>

              {/* Source search */}
              <motion.div
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.1 }}
                className="p-6 rounded-2xl bg-bg-secondary border border-border-primary"
              >
                <div className="flex items-center gap-3 mb-4">
                  <Library size={20} className="text-purple-400" />
                  <h2 className="text-lg font-bold text-text-primary">
                    {language === 'ru' ? '–ü–æ–∏—Å–∫ –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤' : 'Find Academic Sources'}
                  </h2>
                </div>

                <div className="flex gap-2 mb-4">
                  <input
                    type="text"
                    value={sourceSearch}
                    onChange={(e) => setSourceSearch(e.target.value)}
                    onKeyDown={(e) => e.key === 'Enter' && handleSearchSources()}
                    placeholder={language === 'ru' ? '–ü–æ–∏—Å–∫ —Å—Ç–∞—Ç–µ–π, –∫–Ω–∏–≥, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π...' : 'Search articles, books, research...'}
                    className="flex-1 px-4 py-3 rounded-xl bg-bg-tertiary border border-border-primary text-text-primary placeholder-text-muted focus:border-purple-500 transition-all"
                  />
                  <button
                    onClick={handleSearchSources}
                    disabled={isSearching}
                    className="px-6 py-3 rounded-xl bg-purple-500 hover:bg-purple-600 text-white font-medium transition-colors disabled:opacity-50 flex items-center gap-2"
                  >
                    {isSearching ? <Loader2 size={18} className="animate-spin" /> : <Search size={18} />}
                    {language === 'ru' ? '–ù–∞–π—Ç–∏' : 'Search'}
                  </button>
                </div>

                {/* Search results */}
                {searchResults.length > 0 && (
                  <div className="space-y-2 max-h-64 overflow-y-auto">
                    {searchResults.map((source) => (
                      <SourceCard
                        key={source.id}
                        source={source}
                        isSelected={selectedSources.some(s => s.id === source.id)}
                        onAdd={() => handleAddSource(source)}
                        onRemove={() => handleRemoveSource(source.id)}
                        language={language}
                      />
                    ))}
                  </div>
                )}
              </motion.div>
            </div>

            {/* Sidebar - Selected sources */}
            <div className="space-y-6">
              <motion.div
                initial={{ opacity: 0, x: 20 }}
                animate={{ opacity: 1, x: 0 }}
                className="p-6 rounded-2xl bg-bg-secondary border border-border-primary sticky top-6"
              >
                <div className="flex items-center justify-between mb-4">
                  <h2 className="text-lg font-bold text-text-primary flex items-center gap-2">
                    <BookMarked size={18} className="text-emerald-400" />
                    {language === 'ru' ? '–í—ã–±—Ä–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏' : 'Selected Sources'}
                  </h2>
                  <span className="px-2 py-1 rounded-full bg-purple-500/20 text-purple-400 text-xs font-medium">
                    {selectedSources.length}
                  </span>
                </div>

                {selectedSources.length === 0 ? (
                  <p className="text-sm text-text-muted text-center py-8">
                    {language === 'ru' ? '–î–æ–±–∞–≤—å—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–ª—è —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è' : 'Add sources for citations'}
                  </p>
                ) : (
                  <div className="space-y-2 max-h-80 overflow-y-auto">
                    {selectedSources.map((source) => (
                      <div
                        key={source.id}
                        className="p-3 rounded-lg bg-bg-tertiary group"
                      >
                        <div className="flex items-start justify-between gap-2">
                          <div className="flex-1 min-w-0">
                            <p className="text-sm text-text-primary font-medium truncate">
                              {source.title}
                            </p>
                            <p className="text-xs text-text-muted truncate">
                              {source.authors[0]} {source.year && `(${source.year})`}
                            </p>
                          </div>
                          <button
                            onClick={() => handleRemoveSource(source.id)}
                            className="p-1 rounded hover:bg-red-500/20 text-text-muted hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100"
                          >
                            <Trash2 size={14} />
                          </button>
                        </div>
                      </div>
                    ))}
                  </div>
                )}

                {/* Sections preview */}
                <div className="mt-6 pt-6 border-t border-border-primary">
                  <h3 className="text-sm font-medium text-text-secondary mb-3">
                    {language === 'ru' ? '–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç—ã' : 'Document Structure'}
                  </h3>
                  <div className="space-y-1">
                    {selectedType.sections.map((section, i) => (
                      <div key={i} className="flex items-center gap-2 text-sm text-text-muted">
                        <div className="w-5 h-5 rounded-full bg-bg-tertiary flex items-center justify-center text-xs">
                          {i + 1}
                        </div>
                        {section}
                      </div>
                    ))}
                  </div>
                </div>

                {/* Generate button */}
                <motion.button
                  whileHover={{ scale: isGenerating ? 1 : 1.02 }}
                  whileTap={{ scale: isGenerating ? 1 : 0.98 }}
                  onClick={handleGenerate}
                  disabled={!topic.trim() || isGenerating}
                  className="w-full mt-6 px-6 py-4 rounded-xl bg-gradient-to-r from-purple-500 to-pink-600 text-white font-bold text-lg disabled:opacity-50 disabled:cursor-not-allowed flex flex-col items-center gap-2"
                >
                  {isGenerating ? (
                    <>
                      <div className="flex items-center gap-3">
                        <Loader2 size={24} className="animate-spin" />
                        <span>
                          {retryCount > 0 
                            ? `${language === 'ru' ? '–ü–æ–≤—Ç–æ—Ä' : 'Retry'} ${retryCount}/${MAX_RETRIES}...` 
                            : generationPhase || (language === 'ru' ? '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è...' : 'Generating...')}
                        </span>
                      </div>
                      {/* Progress bar */}
                      <div className="w-full bg-white/20 rounded-full h-2 mt-1">
                        <motion.div
                          className="h-2 rounded-full bg-white"
                          initial={{ width: '0%' }}
                          animate={{ width: `${generationProgress}%` }}
                          transition={{ duration: 0.5, ease: 'easeOut' }}
                        />
                      </div>
                      <span className="text-xs text-white/70">{generationProgress}%</span>
                    </>
                  ) : (
                    <div className="flex items-center gap-3">
                      <Sparkles size={24} />
                      {language === 'ru' ? '–°–æ–∑–¥–∞—Ç—å —Ä–∞–±–æ—Ç—É' : 'Generate Paper'}
                    </div>
                  )}
                </motion.button>
              </motion.div>
            </div>
          </div>

          {/* Limit Warning Modal */}
          <AnimatePresence>
            {limitWarning.show && (
              <motion.div
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                exit={{ opacity: 0 }}
                className="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4"
                onClick={() => setLimitWarning(prev => ({ ...prev, show: false }))}
              >
                <motion.div
                  initial={{ opacity: 0, scale: 0.9, y: 20 }}
                  animate={{ opacity: 1, scale: 1, y: 0 }}
                  exit={{ opacity: 0, scale: 0.9, y: 20 }}
                  onClick={(e) => e.stopPropagation()}
                  className="bg-bg-secondary border border-border-primary rounded-2xl p-6 max-w-md w-full shadow-2xl"
                >
                  {/* Icon */}
                  <div className="flex items-center justify-between mb-4">
                    <div className="w-12 h-12 rounded-xl bg-amber-500/20 flex items-center justify-center">
                      <ShieldAlert size={24} className="text-amber-400" />
                    </div>
                    <button
                      onClick={() => setLimitWarning(prev => ({ ...prev, show: false }))}
                      className="p-2 rounded-lg text-text-muted hover:text-text-primary hover:bg-bg-tertiary transition-colors"
                    >
                      <X size={18} />
                    </button>
                  </div>

                  {/* Title */}
                  <h3 className="text-xl font-bold text-text-primary mb-2">
                    {limitWarning.title}
                  </h3>

                  {/* Reason */}
                  <p className="text-text-secondary mb-4">
                    {limitWarning.reason}
                  </p>

                  {/* Remaining info */}
                  <div className="p-4 rounded-xl bg-bg-tertiary border border-border-primary mb-6">
                    <div className="flex items-center justify-between">
                      <span className="text-sm text-text-muted">
                        {limitWarning.type === 'works'
                          ? (language === 'ru' ? '–û—Å—Ç–∞–ª–æ—Å—å —Ä–∞–±–æ—Ç' : 'Works remaining')
                          : (language === 'ru' ? '–û—Å—Ç–∞–ª–æ—Å—å –≥–µ–Ω–µ—Ä–∞—Ü–∏–π —Å–µ–≥–æ–¥–Ω—è' : 'Generations remaining today')}
                      </span>
                      <span className={`text-lg font-bold ${limitWarning.remaining > 0 ? 'text-amber-400' : 'text-red-400'}`}>
                        {limitWarning.remaining}
                      </span>
                    </div>
                  </div>

                  {/* Actions */}
                  <div className="flex gap-3">
                    <button
                      onClick={() => setLimitWarning(prev => ({ ...prev, show: false }))}
                      className="flex-1 px-4 py-3 rounded-xl bg-bg-tertiary text-text-secondary hover:text-text-primary transition-colors font-medium"
                    >
                      {language === 'ru' ? '–ó–∞–∫—Ä—ã—Ç—å' : 'Close'}
                    </button>
                    <button
                      onClick={() => {
                        setLimitWarning(prev => ({ ...prev, show: false }));
                        navigate('/pricing');
                      }}
                      className="flex-1 px-4 py-3 rounded-xl bg-gradient-to-r from-purple-500 to-pink-600 text-white font-medium flex items-center justify-center gap-2 hover:opacity-90 transition-opacity"
                    >
                      <Crown size={18} />
                      {language === 'ru' ? '–£–ª—É—á—à–∏—Ç—å –ø–ª–∞–Ω' : 'Upgrade Plan'}
                    </button>
                  </div>
                </motion.div>
              </motion.div>
            )}
          </AnimatePresence>
        </div>
      </div>
    );
  }

  // –®–∞–≥ 3: –†–µ–¥–∞–∫—Ç–æ—Ä
  if (step === 'editor' && document && selectedType) {
    return (
      <div className="h-screen bg-bg-primary flex overflow-hidden">
        {/* Sidebar - Sources */}
        <AnimatePresence>
          {showSourcePanel && (
            <motion.aside
              initial={{ width: 0, opacity: 0 }}
              animate={{ width: 320, opacity: 1 }}
              exit={{ width: 0, opacity: 0 }}
              className="bg-bg-secondary border-r border-border-primary flex flex-col overflow-hidden"
            >
              <div className="p-4 border-b border-border-primary">
                <div className="flex items-center justify-between mb-4">
                  <h2 className="font-bold text-text-primary flex items-center gap-2">
                    <Library size={18} />
                    {language === 'ru' ? '–ò—Å—Ç–æ—á–Ω–∏–∫–∏' : 'Sources'}
                  </h2>
                  <span className="px-2 py-0.5 rounded-full bg-purple-500/20 text-purple-400 text-xs">
                    {selectedSources.length}
                  </span>
                </div>

                {/* Search */}
                <div className="flex gap-2">
                  <input
                    type="text"
                    value={sourceSearch}
                    onChange={(e) => setSourceSearch(e.target.value)}
                    onKeyDown={(e) => e.key === 'Enter' && handleSearchSources()}
                    placeholder={language === 'ru' ? '–ü–æ–∏—Å–∫...' : 'Search...'}
                    className="flex-1 px-3 py-2 rounded-lg bg-bg-tertiary border border-border-primary text-text-primary text-sm placeholder-text-muted"
                  />
                  <button
                    onClick={handleSearchSources}
                    disabled={isSearching}
                    className="p-2 rounded-lg bg-purple-500 hover:bg-purple-600 text-white disabled:opacity-50"
                  >
                    {isSearching ? <Loader2 size={16} className="animate-spin" /> : <Search size={16} />}
                  </button>
                </div>

                {/* Auto-find button */}
                <button
                  onClick={handleAutoFindSources}
                  disabled={isSearching}
                  className="w-full mt-2 px-3 py-2 rounded-lg bg-bg-tertiary border border-border-primary text-text-secondary hover:text-text-primary hover:border-purple-500/50 text-sm flex items-center justify-center gap-2 transition-all"
                >
                  <Wand2 size={14} />
                  {language === 'ru' ? '–ê–≤—Ç–æ-–ø–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É' : 'Auto-find for text'}
                </button>
              </div>

              {/* Selected sources */}
              <div className="flex-1 overflow-y-auto p-4 space-y-2">
                {selectedSources.map((source) => (
                  <div
                    key={source.id}
                    className="p-3 rounded-lg bg-bg-tertiary hover:bg-bg-primary group cursor-pointer transition-colors"
                    onClick={() => insertCitation(source)}
                  >
                    <div className="flex items-start gap-2">
                      <Quote size={14} className="text-purple-400 mt-1 flex-shrink-0" />
                      <div className="flex-1 min-w-0">
                        <p className="text-sm text-text-primary font-medium line-clamp-2">
                          {source.title}
                        </p>
                        <p className="text-xs text-text-muted mt-1">
                          {source.authors[0]} ({source.year})
                        </p>
                        <p className="text-xs text-purple-400 mt-1 opacity-0 group-hover:opacity-100 transition-opacity">
                          {language === 'ru' ? '–ö–ª–∏–∫ = –≤—Å—Ç–∞–≤–∏—Ç—å —Ü–∏—Ç–∞—Ç—É' : 'Click to insert citation'}
                        </p>
                      </div>
                      <button
                        onClick={(e) => { e.stopPropagation(); handleRemoveSource(source.id); }}
                        className="p-1 rounded hover:bg-red-500/20 text-text-muted hover:text-red-400 opacity-0 group-hover:opacity-100 transition-all"
                      >
                        <Trash2 size={12} />
                      </button>
                    </div>
                  </div>
                ))}

                {/* Search results */}
                {searchResults.length > 0 && (
                  <>
                    <div className="text-xs text-text-muted uppercase tracking-wider pt-4 pb-2">
                      {language === 'ru' ? '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞' : 'Search Results'}
                    </div>
                    {searchResults.slice(0, 5).map((source) => (
                      <SourceCard
                        key={source.id}
                        source={source}
                        isSelected={selectedSources.some(s => s.id === source.id)}
                        onAdd={() => handleAddSource(source)}
                        onRemove={() => handleRemoveSource(source.id)}
                        language={language}
                        compact
                      />
                    ))}
                  </>
                )}
              </div>

              {/* Citation style */}
              <div className="p-4 border-t border-border-primary">
                <label className="text-xs text-text-muted uppercase tracking-wider mb-2 block">
                  {language === 'ru' ? '–°—Ç–∏–ª—å —Ü–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏—è' : 'Citation Style'}
                </label>
                <select
                  value={citationStyle}
                  onChange={(e) => setCitationStyle(e.target.value as CitationStyle)}
                  className="w-full px-3 py-2 rounded-lg bg-bg-tertiary border border-border-primary text-text-primary text-sm"
                >
                  {CITATION_STYLES.map((style) => (
                    <option key={style.id} value={style.id}>{style.name}</option>
                  ))}
                </select>
              </div>
            </motion.aside>
          )}
        </AnimatePresence>

        {/* Main editor */}
        <main className="flex-1 flex flex-col overflow-hidden">
          {/* Toolbar */}
          <header className="flex-shrink-0 px-6 py-2.5 border-b border-border-primary bg-bg-primary/90 backdrop-blur-sm flex items-center justify-between">
            <div className="flex items-center gap-3">
              <button
                onClick={() => { setStep('select'); setDocument(null); }}
                className="flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-text-muted hover:text-text-primary hover:bg-bg-tertiary transition-colors text-sm"
              >
                <ChevronLeft size={18} />
                {language === 'ru' ? '–ù–∞–∑–∞–¥' : 'Back'}
              </button>

              <div className="h-6 w-px bg-border-primary" />

              <button
                onClick={() => setShowSourcePanel(!showSourcePanel)}
                className={`p-2 rounded-lg transition-colors ${showSourcePanel ? 'bg-purple-500/20 text-purple-400' : 'text-text-muted hover:text-text-primary'}`}
              >
                <Library size={20} />
              </button>
              
              <div className="h-6 w-px bg-border-primary" />

              {/* Formatting buttons */}
              <div className="flex items-center gap-1">
                <button onClick={formatBold} title="–ñ–∏—Ä–Ω—ã–π" className="p-2 rounded-lg text-text-muted hover:text-text-primary hover:bg-bg-tertiary transition-colors">
                  <Bold size={16} />
                </button>
                <button onClick={formatItalic} title="–ö—É—Ä—Å–∏–≤" className="p-2 rounded-lg text-text-muted hover:text-text-primary hover:bg-bg-tertiary transition-colors">
                  <Italic size={16} />
                </button>
                <button onClick={formatUnderline} title="–ü–æ–¥—á—ë—Ä–∫–Ω—É—Ç—ã–π" className="p-2 rounded-lg text-text-muted hover:text-text-primary hover:bg-bg-tertiary transition-colors">
                  <Underline size={16} />
                </button>
                <button onClick={formatHeading1} title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ 1" className="p-2 rounded-lg text-text-muted hover:text-text-primary hover:bg-bg-tertiary transition-colors">
                  <Heading1 size={16} />
                </button>
                <button onClick={formatHeading2} title="–ó–∞–≥–æ–ª–æ–≤–æ–∫ 2" className="p-2 rounded-lg text-text-muted hover:text-text-primary hover:bg-bg-tertiary transition-colors">
                  <Heading2 size={16} />
                </button>
                <button onClick={formatBulletList} title="–°–ø–∏—Å–æ–∫" className="p-2 rounded-lg text-text-muted hover:text-text-primary hover:bg-bg-tertiary transition-colors">
                  <List size={16} />
                </button>
              </div>
            </div>

            <div className="flex items-center gap-3">
              {/* Word count */}
              <div className="text-sm text-text-muted flex items-center gap-2">
                <Hash size={14} />
                {document.content.split(/\s+/).length.toLocaleString()} {language === 'ru' ? '—Å–ª–æ–≤' : 'words'}
              </div>

              {/* Export */}
              <div className="relative group">
                <button className="px-4 py-2 rounded-lg bg-bg-tertiary border border-border-primary text-text-primary flex items-center gap-2 hover:border-purple-500/50 transition-colors">
                  <Download size={16} />
                  {language === 'ru' ? '–≠–∫—Å–ø–æ—Ä—Ç' : 'Export'}
                  <ChevronDown size={14} />
                </button>
                <div className="absolute right-0 top-full mt-2 py-2 w-48 rounded-xl bg-bg-secondary border border-border-primary shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-10">
                  <button onClick={() => handleExport('docx')} className="w-full px-4 py-2 text-left text-sm text-text-secondary hover:text-text-primary hover:bg-bg-tertiary">
                    üìÑ Word (.docx)
                  </button>
                  <button onClick={() => handleExport('txt')} className="w-full px-4 py-2 text-left text-sm text-text-secondary hover:text-text-primary hover:bg-bg-tertiary">
                    üìù Text (.txt)
                  </button>
                  <button onClick={() => handleExport('pdf')} className="w-full px-4 py-2 text-left text-sm text-text-secondary hover:text-text-primary hover:bg-bg-tertiary">
                    üìï PDF
                  </button>
                  <div className="h-px bg-border-primary my-1" />
                  <button onClick={() => handleExport('bibtex')} className="w-full px-4 py-2 text-left text-sm text-text-secondary hover:text-text-primary hover:bg-bg-tertiary">
                    üìö BibTeX (.bib)
                  </button>
                  <button onClick={() => handleExport('ris')} className="w-full px-4 py-2 text-left text-sm text-text-secondary hover:text-text-primary hover:bg-bg-tertiary">
                    üìö RIS (.ris)
                  </button>
                </div>
              </div>

              {/* Save */}
              <button
                onClick={() => document && saveDocument(document)}
                className="px-4 py-2 rounded-lg bg-purple-500 hover:bg-purple-600 text-white flex items-center gap-2 transition-colors"
              >
                <Save size={16} />
                {language === 'ru' ? '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' : 'Save'}
              </button>

              {/* Plagiarism check toggle */}
              <button
                onClick={() => setShowPlagiarismPanel(!showPlagiarismPanel)}
                className={`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${
                  showPlagiarismPanel
                    ? 'bg-emerald-500/20 text-emerald-400 border border-emerald-500/30'
                    : 'bg-bg-tertiary border border-border-primary text-text-secondary hover:text-text-primary hover:border-emerald-500/50'
                }`}
              >
                <FileCheck size={16} />
                {language === 'ru' ? '–ê–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç' : 'Plagiarism'}
              </button>
            </div>
          </header>

          {/* Content */}
          <div className="flex-1 overflow-hidden flex">
            {/* Sections sidebar */}
            <div className="w-52 bg-bg-secondary/30 border-r border-border-primary flex flex-col overflow-hidden">
              <div className="p-4 pb-2">
                <h3 className="text-[11px] text-text-muted/50 uppercase tracking-widest font-semibold mb-1">
                  {language === 'ru' ? '–†–∞–∑–¥–µ–ª—ã' : 'Sections'}
                </h3>
                <p className="text-[11px] text-text-muted/40">
                  {activeSection + 1} / {document.sections.length}
                </p>
              </div>
              {/* Section progress bar */}
              <div className="px-4 pb-3">
                <div className="h-1 bg-bg-tertiary rounded-full overflow-hidden">
                  <div 
                    className="h-full bg-gradient-to-r from-purple-500 to-pink-500 rounded-full transition-all duration-300"
                    style={{ width: `${((activeSection + 1) / document.sections.length) * 100}%` }}
                  />
                </div>
              </div>
              <div className="flex-1 overflow-y-auto px-3 pb-3 space-y-0.5">
                {document.sections.map((section, i) => {
                  const hasContent = section.content.trim().length > 0;
                  const wordCount = section.content.split(/\s+/).filter(Boolean).length;
                  return (
                    <button
                      key={i}
                      onClick={() => setActiveSection(i)}
                      className={`w-full px-3 py-2.5 rounded-xl text-left transition-all group ${
                        activeSection === i
                          ? 'bg-purple-500/15 border border-purple-500/20'
                          : 'hover:bg-bg-tertiary/60'
                      }`}
                    >
                      <div className="flex items-start gap-2">
                        <span className={`w-5 h-5 rounded-md flex items-center justify-center text-[11px] font-bold flex-shrink-0 mt-0.5 ${
                          activeSection === i 
                            ? 'bg-purple-500 text-white' 
                            : hasContent 
                              ? 'bg-emerald-500/20 text-emerald-400' 
                              : 'bg-bg-tertiary text-text-muted/50'
                        }`}>
                          {hasContent && activeSection !== i ? '‚úì' : i + 1}
                        </span>
                        <div className="flex-1 min-w-0">
                          <p className={`text-[13px] leading-tight truncate ${
                            activeSection === i ? 'text-purple-400 font-medium' : 'text-text-secondary'
                          }`}>
                            {section.title}
                          </p>
                          {hasContent && (
                            <p className="text-[10px] text-text-muted/40 mt-0.5">{wordCount} —Å–ª–æ–≤</p>
                          )}
                        </div>
                      </div>
                    </button>
                  );
                })}
              </div>
            </div>

            {/* Editor + plagiarism panel area */}
            <div className="flex-1 flex overflow-hidden">
            <div className="flex-1 p-8 overflow-y-auto">
              <div className="max-w-3xl mx-auto">
                <div className="mb-8">
                  <h1 className="text-2xl font-bold text-text-primary mb-1">{document.title}</h1>
                  <div className="flex items-center gap-3 text-sm text-text-muted/60">
                    <span>{selectedType.name}</span>
                    <span className="w-1 h-1 rounded-full bg-text-muted/30" />
                    <span>{new Date(document.createdAt).toLocaleDateString()}</span>
                    <span className="w-1 h-1 rounded-full bg-text-muted/30" />
                    <span>{document.content.split(/\s+/).length.toLocaleString()} —Å–ª–æ–≤</span>
                  </div>
                </div>

                {/* Current section */}
                <div className="mb-8">
                  <div className="flex items-center gap-3 mb-4">
                    <div className="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center text-purple-400 text-sm font-bold">
                      {activeSection + 1}
                    </div>
                    <h2 className="text-xl font-bold text-text-primary">
                      {document.sections[activeSection]?.title}
                    </h2>
                    <div className="flex-1" />
                    <span className="text-xs text-text-muted/40 tabular-nums">
                      {(document.sections[activeSection]?.content || '').split(/\s+/).filter(Boolean).length} —Å–ª–æ–≤
                    </span>
                  </div>
                  <div className="relative group">
                  <textarea
                    ref={editorRef}
                    value={document.sections[activeSection]?.content || ''}
                    onChange={(e) => {
                      const newSections = [...document.sections];
                      newSections[activeSection] = {
                        ...newSections[activeSection],
                        content: e.target.value,
                      };
                      setDocument({
                        ...document,
                        sections: newSections,
                        content: newSections.map(s => `## ${s.title}\n\n${s.content}`).join('\n\n'),
                        wordCount: newSections.map(s => s.content).join(' ').split(/\s+/).length,
                      });
                    }}
                    className="w-full min-h-[500px] px-6 py-5 rounded-xl bg-bg-tertiary/50 border border-border-primary text-text-primary text-base leading-[2] focus:border-purple-500/50 focus:ring-2 focus:ring-purple-500/10 transition-all resize-none placeholder:text-text-muted/30"
                    style={{ lineHeight: '2' }}
                    placeholder={language === 'ru' ? '–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∏–ª–∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç...' : 'Start writing or edit text...'}
                  />
                  </div>
                </div>

                {/* Navigation */}
                <div className="flex justify-between items-center">
                  <button
                    onClick={() => setActiveSection(Math.max(0, activeSection - 1))}
                    disabled={activeSection === 0}
                    className="px-4 py-2.5 rounded-xl bg-bg-secondary border border-border-primary text-text-secondary hover:text-text-primary hover:border-purple-500/30 disabled:opacity-30 disabled:cursor-not-allowed flex items-center gap-2 transition-all text-sm"
                  >
                    <ChevronLeft size={16} />
                    {language === 'ru' ? '–ü—Ä–µ–¥—ã–¥—É—â–∏–π' : 'Previous'}
                  </button>
                  <span className="text-xs text-text-muted/40 tabular-nums">
                    {activeSection + 1} –∏–∑ {document.sections.length}
                  </span>
                  <button
                    onClick={() => setActiveSection(Math.min(document.sections.length - 1, activeSection + 1))}
                    disabled={activeSection === document.sections.length - 1}
                    className="px-4 py-2.5 rounded-xl bg-bg-secondary border border-border-primary text-text-secondary hover:text-text-primary hover:border-purple-500/30 disabled:opacity-30 disabled:cursor-not-allowed flex items-center gap-2 transition-all text-sm"
                  >
                    {language === 'ru' ? '–°–ª–µ–¥—É—é—â–∏–π' : 'Next'}
                    <ChevronRight size={16} />
                  </button>
                </div>

                {/* Bibliography preview */}
                {selectedSources.length > 0 && activeSection === document.sections.length - 1 && (
                  <div className="mt-12 pt-8 border-t border-border-primary">
                    <h2 className="text-xl font-bold text-text-primary mb-4 flex items-center gap-2">
                      <BookMarked size={20} className="text-emerald-400" />
                      {language === 'ru' ? '–°–ø–∏—Å–æ–∫ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã' : 'Bibliography'}
                    </h2>
                    <div className="space-y-3">
                      {selectedSources.map((source, i) => {
                        const citation = formatCitation(source, citationStyle);
                        return (
                          <p key={source.id} className="text-text-secondary text-sm pl-6 -indent-6">
                            {citationStyle === 'ieee' || citationStyle === 'vancouver' 
                              ? `[${i + 1}] ` 
                              : ''
                            }
                            {citation.formatted}
                          </p>
                        );
                      })}
                    </div>
                  </div>
                )}
              </div>
            </div>

            {/* Plagiarism/AI Detection Panel */}
            <AnimatePresence>
              {showPlagiarismPanel && (
                <motion.div
                  initial={{ width: 0, opacity: 0 }}
                  animate={{ width: 380, opacity: 1 }}
                  exit={{ width: 0, opacity: 0 }}
                  className="border-l border-border-primary bg-bg-secondary/50 overflow-hidden flex flex-col"
                >
                  <div className="p-4 border-b border-border-primary flex-shrink-0">
                    <div className="flex items-center justify-between mb-3">
                      <h3 className="font-bold text-text-primary flex items-center gap-2">
                        <FileCheck size={18} className="text-emerald-400" />
                        {language === 'ru' ? '–ê–Ω—Ç–∏–ø–ª–∞–≥–∏–∞—Ç' : 'Plagiarism Check'}
                      </h3>
                      <button
                        onClick={() => setShowPlagiarismPanel(false)}
                        className="p-1.5 rounded-lg text-text-muted hover:text-text-primary hover:bg-bg-tertiary transition-colors"
                      >
                        ‚úï
                      </button>
                    </div>
                    <div className="flex gap-1 bg-bg-tertiary rounded-lg p-1">
                      <button
                        onClick={() => setPlagiarismTab('check')}
                        className={`flex-1 px-3 py-1.5 rounded-md text-xs font-medium transition-all ${
                          plagiarismTab === 'check'
                            ? 'bg-emerald-500 text-white'
                            : 'text-text-muted hover:text-text-primary'
                        }`}
                      >
                        {language === 'ru' ? '–ü—Ä–æ–≤–µ—Ä–∫–∞' : 'Check'}
                      </button>
                      <button
                        onClick={() => setPlagiarismTab('detect')}
                        className={`flex-1 px-3 py-1.5 rounded-md text-xs font-medium transition-all ${
                          plagiarismTab === 'detect'
                            ? 'bg-orange-500 text-white'
                            : 'text-text-muted hover:text-text-primary'
                        }`}
                      >
                        {language === 'ru' ? 'AI-–¥–µ—Ç–µ–∫—Ç–æ—Ä' : 'AI Detect'}
                      </button>
                    </div>
                  </div>
                  <div className="flex-1 overflow-y-auto p-4">
                    {plagiarismTab === 'check' && (
                      <PlagiarismChecker text={document.content} compact />
                    )}
                    {plagiarismTab === 'detect' && (
                      <Suspense fallback={<div className="text-center py-8 text-text-muted"><Loader2 className="w-6 h-6 animate-spin mx-auto mb-2" />Loading...</div>}>
                        <AIDetectionCheckerLazy text={document.content} compact />
                      </Suspense>
                    )}
                  </div>
                </motion.div>
              )}
            </AnimatePresence>
            </div>
          </div>
        </main>
      </div>
    );
  }

  return null;
};

// ================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ ==================

// Source card component
const SourceCard = ({ 
  source, 
  isSelected, 
  onAdd, 
  onRemove, 
  language,
  compact = false,
}: { 
  source: Source; 
  isSelected: boolean; 
  onAdd: () => void; 
  onRemove: () => void;
  language: string;
  compact?: boolean;
}) => (
  <div className={`p-3 rounded-lg ${compact ? 'bg-bg-primary' : 'bg-bg-tertiary'} border border-border-primary hover:border-purple-500/30 transition-colors`}>
    <div className="flex items-start gap-3">
      <div className="flex-1 min-w-0">
        <p className={`${compact ? 'text-xs' : 'text-sm'} text-text-primary font-medium line-clamp-2`}>
          {source.title}
        </p>
        <p className="text-xs text-text-muted mt-1">
          {source.authors.slice(0, 2).join(', ')}
          {source.authors.length > 2 && ' et al.'}
          {source.year && ` (${source.year})`}
        </p>
        {!compact && source.journal && (
          <p className="text-xs text-text-muted mt-1 italic truncate">{source.journal}</p>
        )}
        {!compact && source.citationCount !== undefined && (
          <div className="flex items-center gap-3 mt-2 text-xs text-text-muted">
            <span className="flex items-center gap-1">
              <Quote size={10} />
              {source.citationCount.toLocaleString()} {language === 'ru' ? '—Ü–∏—Ç–∞—Ç' : 'citations'}
            </span>
            {source.doi && (
              <a
                href={`https://doi.org/${source.doi}`}
                target="_blank"
                rel="noopener noreferrer"
                className="flex items-center gap-1 text-purple-400 hover:text-purple-300"
                onClick={(e) => e.stopPropagation()}
              >
                <ExternalLink size={10} />
                DOI
              </a>
            )}
          </div>
        )}
      </div>
      <button
        onClick={isSelected ? onRemove : onAdd}
        className={`p-1.5 rounded-lg transition-colors flex-shrink-0 ${
          isSelected
            ? 'bg-emerald-500/20 text-emerald-400 hover:bg-red-500/20 hover:text-red-400'
            : 'bg-purple-500/20 text-purple-400 hover:bg-purple-500/40'
        }`}
      >
        {isSelected ? <CheckCircle size={16} /> : <Plus size={16} />}
      </button>
    </div>
  </div>
);

// Recent documents component
const RecentDocuments = ({ navigate, language }: { navigate: (path: string) => void; language: string }) => {
  const [docs, setDocs] = useState<AcademicDocument[]>([]);

  useEffect(() => {
    const saved = localStorage.getItem('academic-documents');
    if (saved) {
      const parsed = JSON.parse(saved);
      setDocs(parsed.slice(0, 6));
    }
  }, []);

  if (docs.length === 0) {
    return (
      <div className="text-center py-12 text-text-muted">
        <FileText size={48} className="mx-auto mb-4 opacity-50" />
        <p>{language === 'ru' ? '–ü–æ–∫–∞ –Ω–µ—Ç —Ä–∞–±–æ—Ç. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é!' : 'No works yet. Create your first one!'}</p>
      </div>
    );
  }

  return (
    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {docs.map((doc) => {
        const docType = DOCUMENT_TYPES.find(t => t.id === doc.type);
        return (
          <motion.button
            key={doc.id}
            whileHover={{ scale: 1.02 }}
            whileTap={{ scale: 0.98 }}
            onClick={() => navigate(`/academic/${doc.type}/${doc.id}`)}
            className="p-4 rounded-xl bg-bg-secondary border border-border-primary hover:border-purple-500/50 transition-all text-left"
          >
            <div className="flex items-start gap-3">
              <div className={`w-10 h-10 rounded-lg bg-gradient-to-br ${docType?.color || 'from-gray-500 to-gray-600'} flex items-center justify-center flex-shrink-0`}>
                {docType?.icon && <docType.icon size={20} className="text-white" />}
              </div>
              <div className="flex-1 min-w-0">
                <p className="text-text-primary font-medium truncate">{doc.title}</p>
                <p className="text-xs text-text-muted mt-1">
                  {docType?.name || doc.type} ‚Ä¢ {doc.wordCount.toLocaleString()} {language === 'ru' ? '—Å–ª–æ–≤' : 'words'}
                </p>
                <p className="text-xs text-text-muted mt-1">
                  {new Date(doc.updatedAt).toLocaleDateString()}
                </p>
              </div>
            </div>
          </motion.button>
        );
      })}
    </div>
  );
};

export default AcademicWorksPage;
